import{A as P,aQ as W,aR as Y,c as C,a4 as F,ao as Z,e as i,f as I,w as f,g as v,h as u,P as ee,C as _,D as N,E as O,l as y,x as M,k as c,t as V,S as R,az as E,ay as te,aA as ae,F as G,G as H,y as A,aB as se,a2 as Q,s as le,aD as X,aC as re,aw as J,X as oe,r as K,aI as ue}from"./index-54e545bb.js";const ne={class:"w-full"},ie=["onClick"],de={class:"flex items-center"},ce={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},fe={key:1,class:"text-base leading-5 text-gray-500"},pe={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},me={class:"relative px-1.5 pt-0.5"},ye={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},ge={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},he={key:0,class:"border-t p-1.5 pb-0.5"},ve={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup(S,{expose:j,emit:s}){const r=S,d=s,p=P(""),b=P(!1),B=P(null),w=W(),g=Y(),z=C(()=>"value"in w),k=C({get(){return z.value?w.value:r.modelValue},set(e){p.value="",e&&(b.value=!1),d(z.value?"change":"update:modelValue",e)}});function q(){b.value=!1}const t=C(()=>{var a;return!r.options||r.options.length==0?[]:((a=r.options[0])!=null&&a.group?r.options:[{group:"",items:r.options}]).map((o,n)=>({key:n,group:o.group,hideLabel:o.hideLabel||!1,items:r.filterable?h(o.items):o.items})).filter(o=>o.items.length>0)});function h(e){return p.value?e.filter(a=>[a.label,a.value].some(n=>(n||"").toString().toLowerCase().includes(p.value.toLowerCase()))):e}function l(e){if(typeof e=="string"){let o=t.value.flatMap(n=>n.items).find(n=>n.value===e);return(o==null?void 0:o.label)||e}return e==null?void 0:e.label}F(p,e=>{d("update:query",e)}),F(b,e=>{e&&Z(()=>{B.value.el.focus()})});const $=C(()=>r.disabled?"text-gray-600":"text-gray-800"),m=C(()=>{let e={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[r.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[r.size],o=r.disabled?"disabled":r.variant,n={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",r.variant==="outline"?"border-gray-300":"border-transparent"]}[o];return[e,a,n,$.value,"transition-colors w-full"]});return j({query:p}),(e,a)=>(i(),I(u(re),{modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=o=>k.value=o),nullable:""},{default:f(({open:o})=>[v(u(ee),{class:"w-full",show:b.value,"onUpdate:show":a[2]||(a[2]=n=>b.value=n)},{target:f(({open:n,togglePopover:L})=>[_(e.$slots,"target",N(O({open:n,togglePopover:L,isOpen:b.value,selectedValue:k.value,displayValue:l})),()=>[y("div",ne,[y("button",{class:M(["flex w-full items-center justify-between focus:outline-none",m.value]),onClick:()=>L()},[y("div",de,[_(e.$slots,"prefix"),k.value?(i(),c("span",ce,V(l(k.value)),1)):(i(),c("span",fe,V(S.placeholder||""),1))]),v(u(R),{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,ie)])])]),body:f(({isOpen:n})=>{var L;return[E(y("div",null,[y("div",pe,[y("div",me,[v(u(te),{ref_key:"search",ref:B,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=x=>{p.value=x.target.value}),value:p.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),y("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=x=>k.value=null)},[v(u(R),{name:"x",class:"w-4"})])]),v(u(ae),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:f(()=>[(i(!0),c(G,null,H(t.value,x=>E((i(),c("div",{class:"mt-1.5",key:x.key},[x.group&&!x.hideLabel?(i(),c("div",ye,V(x.group),1)):A("",!0),(i(!0),c(G,null,H(x.items,D=>(i(),I(u(se),{as:"template",key:D.value,value:D},{default:f(({active:T,selected:U})=>[y("li",{class:M(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":T}])},[_(e.$slots,"item-prefix",Q({ref_for:!0},{active:T,selected:U,option:D})),_(e.$slots,"item-label",Q({ref_for:!0},{active:T,selected:U,option:D}),()=>[le(V(D.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[X,x.items.length>0]])),128)),t.value.length==0?(i(),c("li",ge," No results found ")):A("",!0)]),_:3}),u(g).footer?(i(),c("div",he,[_(e.$slots,"footer",N(O({value:(L=B.value)==null?void 0:L.el._value,close:q})))])):A("",!0)])],512),[[X,n]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},be={class:"space-y-1.5"},xe={key:0,class:"flex flex-col gap-1"},_e={class:"flex-1 font-semibold truncate text-ink-gray-7"},we={class:"flex-1 text-sm truncate text-ink-gray-5"},ke={key:1,class:"flex-1 truncate text-ink-gray-7"},Ce={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:null},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1},pageLength:{type:Number,default:10},hideClearButton:{type:Boolean,default:!1},showDescription:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(S,{emit:j}){const s=S,r=j,d=W(),p=C(()=>"value"in d),b=C({get:()=>p.value?d.value:s.modelValue,set:t=>(t==null?void 0:t.value)&&r(p.value?"change":"update:modelValue",t==null?void 0:t.value)}),B=P(null),w=P("");J(()=>{var t;return(t=B.value)==null?void 0:t.query},t=>{t=t||"",w.value!==t&&(w.value=t,z(t))},{debounce:300,immediate:!0}),J(()=>s.doctype,()=>z(""),{debounce:300,immediate:!0}),F(()=>s==null?void 0:s.filters,t=>{g.update({params:{txt:w.value,doctype:s.doctype,filters:t,page_length:s.pageLength}}),g.reload()},{deep:!0});const g=oe({url:"frappe.desk.search.search_link",cache:[s.doctype,w.value,s.hideMe],method:"POST",params:{txt:w.value,doctype:s.doctype,filters:s.filters,page_length:s.pageLength},transform:t=>{let h=t.map(l=>({value:l.value,label:(l==null?void 0:l.label)||l.value,description:l==null?void 0:l.description}));return!s.hideMe&&(s.doctype=="User"||s.doctype=="HD Agent")&&h.unshift({label:"@me",value:"@me"}),h}});function z(t){var h,l,$;(h=g.data)!=null&&h.length&&t===((l=g.params)==null?void 0:l.txt)&&s.doctype===(($=g.params)==null?void 0:$.doctype)||(g.update({params:{txt:t,doctype:s.doctype,filters:s.filters,page_length:s.pageLength}}),g.reload())}function k(t){r(p.value?"change":"update:modelValue",""),t()}const q=C(()=>[{sm:"text-xs",md:"text-base"}[d.size||"sm"],"text-gray-600"]);return(t,h)=>{const l=K("FeatherIcon"),$=K("Button");return i(),c("div",be,[u(d).label?(i(),c("label",{key:0,class:M(["block",q.value])},V(u(d).label),3)):A("",!0),v(ve,{ref_key:"autocomplete",ref:B,options:u(g).data,modelValue:b.value,"onUpdate:modelValue":h[0]||(h[0]=m=>b.value=m),size:u(d).size||"sm",variant:u(d).variant,placeholder:u(d).placeholder,filterable:!1},ue({target:f(({open:m,togglePopover:e})=>[_(t.$slots,"target",N(O({open:m,togglePopover:e})))]),prefix:f(()=>[_(t.$slots,"prefix")]),"item-prefix":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-prefix",N(O({active:m,selected:e,option:a})))]),"item-label":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-label",N(O({active:m,selected:e,option:a})),()=>[a.description&&S.showDescription?(i(),c("div",xe,[y("div",_e,V(a.label),1),y("div",we,V(a.description),1)])):(i(),c("div",ke,V(a.label),1))])]),_:2},[S.hideClearButton?void 0:{name:"footer",fn:f(({value:m,close:e})=>[u(d).onCreate?(i(),c("div",Ce,[v($,{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:a=>u(d).onCreate(m,e)},{prefix:f(()=>[v(l,{name:"plus",class:"h-4"})]),_:2},1032,["onClick"])])):A("",!0),y("div",null,[v($,{variant:"ghost",class:"w-full !justify-start",label:"Clear",onClick:()=>k(e)},{prefix:f(()=>[v(l,{name:"x",class:"h-4"})]),_:2},1032,["onClick"])])]),key:"0"}]),1032,["options","modelValue","size","variant","placeholder"])])}}};export{$e as _,ve as a};
//# sourceMappingURL=Link-5130f40e.js.map
