import { d as z, A as S, aV as wt, r as j, h as t, e as l, k as o, l as e, g as r, w as C, F, G as H, f as w, t as B, y as k, bt as Ne, b2 as He, j as re, V as $t, v as ie, J as Et, aN as O, z as me, x as q, L as Oe, m as be, n as ge, c as N, M as Le, S as te, bn as It, az as Pe, aD as Ze, C as _e, s as le, H as ke, X as ae, a3 as Ve, K as X, p as Ce, a4 as ve, aX as V, a as Qe, R as J, aI as St, aZ as Bt, W as ze, O as Je, a0 as qe, I as ee, bL as Lt, Z as pe, U as Ee, aM as Ge, bM as Vt, ap as Qt, a_ as Mt, aO as Rt, b as Dt, q as Ft, u as jt, bN as Tt, aE as Ut, Y as Nt, aP as we } from "./index-54e545bb.js"; import { _ as Ht, a as fe, k as W, l as Z, n as se, i as We, o as Ie, u as Ot, c as Pt, p as Zt, s as zt, b as Fe, d as je, F as Jt, C as qt } from "./more-horizontal-b561c647.js"; import { d as Gt } from "./dayjs-8f71cd34.js"; import { u as Ye, c as Wt, a as Yt, _ as Kt, H as Xt, b as en, d as ue, L as tn, e as nn } from "./layoutSettings-2398588d.js"; import { u as Ke, L as ln } from "./bell-07c9731c.js"; import { _ as an } from "./UserAvatar.vue_vue_type_script_setup_true_lang-73349f36.js"; import "./knowledgeBase-de4d1c97.js"; import { _ as Xe } from "./Dropdown.vue_vue_type_script_setup_true_lang-20398480.js"; import { g as et } from "./globalStore-842ad0ec.js"; import { a as on, L as sn } from "./users-ff29ac86.js"; import { _ as rn } from "./Dropdown-a6c1fbb4.js"; import { _ as Se } from "./Avatar.vue_vue_type_script_setup_true_lang-33c4215a.js"; import { F as cn } from "./FileUploader-3bc7c8ba.js"; import { _ as un } from "./Link-5130f40e.js"; import { s as dn } from "./dialogState-e18b28cc.js"; const pn = { class: "sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5" }, mn = { class: "divide-y text-base" }, gn = { class: "mb-2 leading-5" }, fn = { class: "space-x-1 text-gray-700" }, _n = { class: "font-medium text-gray-900" }, vn = { key: 0 }, hn = { key: 1 }, kn = { key: 2 }, Cn = { class: "font-medium text-gray-900" }, bn = { class: "flex items-center gap-2" }, An = { class: "text-sm text-gray-600" }, xn = { key: 0, class: "h-1.5 w-1.5 rounded-full bg-blue-400" }, yn = z({ __name: "Notifications", setup(i) { const n = Ke(), c = Ye(), s = S(null); wt(s, () => { n.visible && n.toggle() }, { ignore: ["#notifications-btn"] }); function a(p) { n.toggle(), !p.read && n.read(p.reference_ticket) } function u(p) { switch (p.notification_type) { case "Mention": return { name: "TicketAgent", params: { ticketId: p.reference_ticket }, hash: "#" + p.reference_comment }; case "Assignment": case "Reaction": return { name: "TicketAgent", params: { ticketId: p.reference_ticket } } } } return (p, d) => { const h = Ht, f = j("Button"), _ = He, b = j("RouterLink"); return t(n).visible ? (l(), o("span", { key: 0, ref_key: "target", ref: s, class: "fixed z-10 h-screen overflow-auto bg-white", style: Ne({ "box-shadow": "8px 0px 8px rgba(0, 0, 0, 0.1)", "max-width": "350px", "min-width": "350px", left: t(c).width }) }, [e("div", pn, [d[2] || (d[2] = e("span", { class: "text-lg font-medium" }, "Notifications", -1)), e("span", null, [r(f, { theme: "blue", variant: "ghost", onClick: d[0] || (d[0] = () => t(n).clear.submit()) }, { icon: C(() => [r(h, { class: "h-4 w-4" })]), _: 1 }), r(f, { theme: "gray", variant: "ghost", onClick: d[1] || (d[1] = () => t(n).toggle()) }, { icon: C(() => [r(_, { class: "h-4 w-4" })]), _: 1 })])]), e("div", mn, [(l(!0), o(F, null, H(t(n).data, m => (l(), w(b, { key: m.name, class: "flex cursor-pointer items-start gap-3.5 px-5 py-2.5 hover:bg-gray-100", to: u(m), onClick: () => { a(m) } }, { default: C(() => [r(t(an), { name: m.user_from }, null, 8, ["name"]), e("span", null, [e("div", gn, [e("span", fn, [e("span", _n, B(m.user_from), 1), m.notification_type === "Mention" ? (l(), o("span", vn, "mentioned you in ticket")) : k("", !0), m.notification_type === "Assignment" ? (l(), o("span", hn, "assigned you a ticket")) : k("", !0), m.notification_type === "Reaction" ? (l(), o("span", kn, "has reopened the ticket")) : k("", !0), e("span", Cn, B(m.reference_ticket), 1)])]), e("div", bn, [e("div", An, B(t(Gt).tz(m.creation).fromNow()), 1), m.read ? k("", !0) : (l(), o("div", xn))])])]), _: 2 }, 1032, ["to", "onClick"]))), 128))])], 4)) : k("", !0) } } }), wn = {}, $n = { width: "32", height: "32", viewBox: "0 0 32 32", fill: "none", xmlns: "http://www.w3.org/2000/svg" }; function En(i, n) { return l(), o("svg", $n, n[0] || (n[0] = [e("rect", { x: "0.75", y: "0.75", width: "30.5", height: "30.5", rx: "6.25", stroke: "currentColor", "stroke-width": "1.5" }, null, -1), e("path", { d: "M24.5011 14.1124C23.3954 12.4873 21.532 11.5477 19.594 11.6747C18.7616 10.1384 17.2211 9.12267 15.4198 9.0084C14.1651 8.93222 12.8979 9.3766 11.9165 10.24C11.2456 10.8367 10.7611 11.5223 10.463 12.2968C10.289 12.7539 9.89151 13.0459 9.46912 13.0459H6.5V15.5852H9.46912C10.9226 15.5852 12.2271 14.6584 12.7737 13.2237C12.9227 12.8301 13.1712 12.4873 13.5439 12.1571C14.0284 11.7255 14.662 11.4969 15.2583 11.535C16.1528 11.5985 16.7863 12.0175 17.1839 12.538C17.6063 13.0205 17.8423 13.7696 17.979 14.5187C18.774 14.2902 19.6437 14.0997 20.476 14.2394C21.1593 14.3536 21.7929 14.7218 22.2525 15.2678C22.327 15.3567 22.4016 15.4456 22.4637 15.5471C23.06 16.4232 23.1718 17.5024 22.7743 18.5689C22.414 19.5592 21.0847 20.4607 19.9791 20.4607H11.3326C10.1524 20.4607 9.18339 19.5592 9.03432 18.4038H6.54969C6.71119 20.9686 8.78585 23 11.3326 23H19.9915C22.1283 23 24.3769 21.451 25.1098 19.4704C25.7931 17.6167 25.5695 15.6614 24.5135 14.0997L24.5011 14.1124Z", fill: "currentColor" }, null, -1)])) } const In = re(wn, [["render", En]]), Sn = {}, Bn = { width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", xmlns: "http://www.w3.org/2000/svg" }; function Ln(i, n) { return l(), o("svg", Bn, n[0] || (n[0] = [$t('<path d="M10 11C12.2091 11 14 9.20914 14 7C14 4.79086 12.2091 3 10 3C7.79086 3 6 4.79086 6 7C6 9.20914 7.79086 11 10 11Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M10.3 15H7C5.93913 15 4.92172 15.4214 4.17157 16.1716C3.42143 16.9217 3 17.9391 3 19V21H11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M22.166 13.834H14.8327C14.3264 13.834 13.916 14.2444 13.916 14.7507V20.2507C13.916 20.7569 14.3264 21.1673 14.8327 21.1673H22.166C22.6723 21.1673 23.0827 20.7569 23.0827 20.2507V14.7507C23.0827 14.2444 22.6723 13.834 22.166 13.834Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M23.0827 15.209L18.9714 17.8215C18.8299 17.9101 18.6663 17.9572 18.4993 17.9572C18.3324 17.9572 18.1688 17.9101 18.0273 17.8215L13.916 15.209" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><g clip-path="url(#clip0_368_1881)"><path d="M16.667 5H21.3337" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M19 2.66699V7.33366" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_368_1881"><rect width="8" height="8" fill="white" transform="translate(15 1)"></rect></clipPath></defs>', 6)])) } const Vn = re(Sn, [["render", Ln]]), Qn = {}, Mn = { width: "16", height: "16", viewBox: "0 0 16 16", fill: "none", xmlns: "http://www.w3.org/2000/svg" }; function Rn(i, n) { return l(), o("svg", Mn, n[0] || (n[0] = [e("path", { "fill-rule": "evenodd", "clip-rule": "evenodd", d: "M8 6.5C9.10457 6.5 10 5.60457 10 4.5C10 3.39543 9.10457 2.5 8 2.5C6.89543 2.5 6 3.39543 6 4.5C6 5.60457 6.89543 6.5 8 6.5ZM8 7.5C9.65685 7.5 11 6.15685 11 4.5C11 2.84315 9.65685 1.5 8 1.5C6.34315 1.5 5 2.84315 5 4.5C5 6.15685 6.34315 7.5 8 7.5ZM12 13.5C13.1046 13.5 14 12.6046 14 11.5C14 10.3954 13.1046 9.5 12 9.5C10.8954 9.5 10 10.3954 10 11.5C10 12.6046 10.8954 13.5 12 13.5ZM12 14.5C13.6569 14.5 15 13.1569 15 11.5C15 9.84315 13.6569 8.5 12 8.5C10.3431 8.5 9 9.84315 9 11.5C9 13.1569 10.3431 14.5 12 14.5ZM6 11.5C6 12.6046 5.10457 13.5 4 13.5C2.89543 13.5 2 12.6046 2 11.5C2 10.3954 2.89543 9.5 4 9.5C5.10457 9.5 6 10.3954 6 11.5ZM7 11.5C7 13.1569 5.65685 14.5 4 14.5C2.34315 14.5 1 13.1569 1 11.5C1 9.84315 2.34315 8.5 4 8.5C5.65685 8.5 7 9.84315 7 11.5Z", fill: "currentColor" }, null, -1)])) } const he = re(Qn, [["render", Rn]]), Dn = {}, Fn = { xmlns: "http://www.w3.org/2000/svg", width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round", class: "feather feather-minimize-2" }; function jn(i, n) { return l(), o("svg", Fn, n[0] || (n[0] = [e("polyline", { points: "4 14 10 14 10 20" }, null, -1), e("polyline", { points: "20 10 14 10 14 4" }, null, -1), e("line", { x1: "14", y1: "10", x2: "21", y2: "3" }, null, -1), e("line", { x1: "3", y1: "21", x2: "10", y2: "14" }, null, -1)])) } const Tn = re(Dn, [["render", jn]]), Un = {}, Nn = { xmlns: "http://www.w3.org/2000/svg", width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round", class: "feather feather-maximize-2" }; function Hn(i, n) { return l(), o("svg", Nn, n[0] || (n[0] = [e("polyline", { points: "15 3 21 3 21 9" }, null, -1), e("polyline", { points: "9 21 3 21 3 15" }, null, -1), e("line", { x1: "21", y1: "3", x2: "14", y2: "10" }, null, -1), e("line", { x1: "3", y1: "21", x2: "10", y2: "14" }, null, -1)])) } const On = re(Un, [["render", Hn]]), Pn = {}, Zn = { width: "16", height: "16", viewBox: "0 0 16 16", fill: "none", xmlns: "http://www.w3.org/2000/svg" }; function zn(i, n) { return l(), o("svg", Zn, n[0] || (n[0] = [e("path", { "fill-rule": "evenodd", "clip-rule": "evenodd", d: "M14.25 8C14.25 11.4518 11.4518 14.25 8 14.25C4.54822 14.25 1.75 11.4518 1.75 8C1.75 4.54822 4.54822 1.75 8 1.75C11.4518 1.75 14.25 4.54822 14.25 8ZM15.25 8C15.25 12.0041 12.0041 15.25 8 15.25C3.99594 15.25 0.75 12.0041 0.75 8C0.75 3.99594 3.99594 0.75 8 0.75C12.0041 0.75 15.25 3.99594 15.25 8ZM7.37988 9.37695V9.44531H8.39062V9.37695C8.39062 9.10352 8.41992 8.88542 8.47852 8.72266C8.53711 8.55664 8.62826 8.41504 8.75195 8.29785C8.87891 8.18066 9.04329 8.06185 9.24512 7.94141C9.56087 7.74609 9.8099 7.51009 9.99219 7.2334C10.1745 6.95345 10.2656 6.61328 10.2656 6.21289C10.2656 5.82878 10.1745 5.49186 9.99219 5.20215C9.81315 4.91244 9.56087 4.6862 9.23535 4.52344C8.90983 4.36068 8.52734 4.2793 8.08789 4.2793C7.69401 4.2793 7.33268 4.35579 7.00391 4.50879C6.67513 4.65853 6.41146 4.88151 6.21289 5.17773C6.01432 5.4707 5.90853 5.82878 5.89551 6.25195H6.96973C6.986 6.0013 7.04948 5.79785 7.16016 5.6416C7.27083 5.4821 7.40755 5.36491 7.57031 5.29004C7.73633 5.21517 7.90885 5.17773 8.08789 5.17773C8.28971 5.17773 8.47363 5.22005 8.63965 5.30469C8.80892 5.38932 8.94075 5.50814 9.03516 5.66113C9.13281 5.81413 9.18164 5.99479 9.18164 6.20312C9.18164 6.47005 9.11003 6.69954 8.9668 6.8916C8.82357 7.0804 8.64453 7.23828 8.42969 7.36523C8.21159 7.50195 8.02279 7.64193 7.86328 7.78516C7.70703 7.92513 7.58659 8.11556 7.50195 8.35645C7.42057 8.59408 7.37988 8.93425 7.37988 9.37695ZM7.37988 11.5205C7.51986 11.654 7.69076 11.7207 7.89258 11.7207C8.09766 11.7207 8.26855 11.654 8.40527 11.5205C8.54525 11.3838 8.61523 11.2161 8.61523 11.0176C8.61523 10.8158 8.54525 10.6481 8.40527 10.5146C8.26855 10.3779 8.09766 10.3096 7.89258 10.3096C7.69076 10.3096 7.51986 10.3779 7.37988 10.5146C7.24316 10.6481 7.1748 10.8158 7.1748 11.0176C7.1748 11.2161 7.24316 11.3838 7.37988 11.5205Z", fill: "currentColor" }, null, -1)])) } const tt = re(Pn, [["render", zn]]), Jn = { class: "flex flex-col justify-center items-center gap-1 mt-4 mb-7" }, qn = { class: "text-base font-medium" }, Gn = { class: "text-p-base font-normal" }, Wn = { class: "flex flex-col gap-2.5 overflow-hidden" }, Yn = { class: "flex justify-between items-center py-0.5" }, Kn = { class: "flex" }, Xn = { class: "flex flex-col gap-1.5 overflow-y-auto" }, el = ["onClick"], tl = { __name: "OnboardingSteps", props: { appName: { type: String, default: "frappecrm" }, title: { type: String, default: "Frappe CRM" }, logo: { type: Object, required: !0 }, afterSkip: { type: Function, default: () => { } }, afterSkipAll: { type: Function, default: () => { } }, afterReset: { type: Function, default: () => { } }, afterResetAll: { type: Function, default: () => { } } }, setup(i) { const n = i; function c(m) { if (m.dependsOn && !m.completed) { const g = a.find(v => v.name === m.dependsOn); if (g && !g.completed) return !0 } return !1 } function s(m) { if (m.dependsOn && !m.completed) { const g = a.find(v => v.name === m.dependsOn); if (g && !g.completed) return `You need to complete "${g.title}" first.` } return "" } const { steps: a, stepsCompleted: u, totalSteps: p, completedPercentage: d, skip: h, skipAll: f, reset: _, resetAll: b } = fe(n.appName); return (m, g) => (l(), o(F, null, [e("div", Jn, [(l(), w(ie(i.logo), { class: "size-10 shrink-0 rounded mb-4" })), e("div", qn, B("Welcome to " + i.title), 1), e("div", Gn, B(`${t(u)}/${t(p)} steps completed`), 1)]), e("div", Wn, [e("div", Yn, [r(Et, { label: `${t(d)}% completed`, theme: t(d) == 100 ? "green" : "orange", size: "lg" }, null, 8, ["label", "theme"]), e("div", Kn, [t(d) != 0 ? (l(), w(O, { key: 0, variant: "ghost", label: "Reset all", onClick: g[0] || (g[0] = () => t(b)(i.afterResetAll)) })) : k("", !0), t(d) != 100 ? (l(), w(O, { key: 1, variant: "ghost", label: "Skip all", onClick: g[1] || (g[1] = () => t(f)(i.afterSkipAll)) })) : k("", !0)])]), e("div", Xn, [(l(!0), o(F, null, H(t(a), v => (l(), o("div", { key: v.title, class: "group w-full flex gap-2 justify-between items-center hover:bg-surface-gray-1 rounded px-2 py-1.5 cursor-pointer", onClick: me(() => !v.completed && !c(v) && v.onClick(), ["stop"]) }, [(l(), w(ie(c(v) ? Oe : "div"), { text: s(v) }, { default: C(() => [e("div", { class: q(["flex gap-2 items-center", [v.completed ? "text-ink-gray-5" : c(v) ? "text-ink-gray-4" : "text-ink-gray-8"]]) }, [(l(), w(ie(v.icon), { class: "h-4" })), e("div", { class: q(["text-base", { "line-through": v.completed }]) }, B(v.title), 3)], 2)]), _: 2 }, 1032, ["text"])), !v.completed && !c(v) ? (l(), w(O, { key: 0, label: "Skip", class: "!h-4 text-xs !text-ink-gray-6 hidden group-hover:flex", onClick: () => t(h)(v.name, i.afterSkip) }, null, 8, ["onClick"])) : c(v) ? k("", !0) : (l(), w(O, { key: 1, label: "Reset", class: "!h-4 text-xs !text-ink-gray-6 hidden group-hover:flex", onClick: me(() => t(_)(v.name, i.afterReset), ["stop"]) }, null, 8, ["onClick"]))], 8, el))), 128))])])], 64)) } }, nl = { class: "flex flex-col gap-2 overflow-hidden" }, ll = { class: "m-1" }, al = { class: "flex justify-between items-center text-base text-ink-gray-5 mx-2" }, ol = { class: "flex flex-col gap-1.5 overflow-y-auto" }, sl = ["onClick"], il = { class: "flex items-center gap-2" }, rl = { class: "text-base text-ink-gray-8" }, cl = { class: "flex flex-col gap-1.5 ml-5" }, ul = ["onClick"], dl = { class: "flex items-center gap-2" }, pl = { class: "text-base text-ink-gray-8" }, ml = { __name: "HelpCenter", props: be({ docsLink: { type: String, default: "https://docs.frappe.io/crm" } }, { modelValue: {}, modelModifiers: {} }), emits: ["update:modelValue"], setup(i) { const n = i, c = S(null), s = S(""), a = ge(i, "modelValue"), u = N(() => s.value ? a.value.filter(h => { const f = h.subArticles.filter(_ => _.title.toLowerCase().includes(s.value.toLowerCase())); return h.title.toLowerCase().includes(s.value.toLowerCase()) || f.length > 0 ? { ...h, subArticles: f } : !1 }) : a.value); function p() { window.open(n.docsLink, "_blank") } function d(h) { window.open(`${n.docsLink}/${h}`, "_blank") } return Le(() => { var h, f; (f = (h = c.value) == null ? void 0 : h.el) == null || f.focus() }), (h, f) => (l(), o("div", nl, [e("div", ll, [r(It, { ref_key: "searchInput", ref: c, placeholder: "Search articles...", modelValue: s.value, "onUpdate:modelValue": f[0] || (f[0] = _ => s.value = _), debounce: 300 }, { prefix: C(() => [r(te, { name: "search", class: "h-4 text-ink-gray-5" })]), _: 1 }, 8, ["modelValue"])]), e("div", al, [f[1] || (f[1] = e("div", null, "All articles", -1)), r(O, { variant: "ghost", onClick: p }, { default: C(() => [r(te, { name: "arrow-up-right", class: "h-4 text-ink-gray-5" })]), _: 1 })]), e("div", ol, [(l(!0), o(F, null, H(u.value, _ => (l(), o("div", { key: _.title, class: "flex flex-col gap-1.5" }, [e("div", { class: "flex items-center justify-between p-1.5 hover:bg-surface-gray-1 rounded cursor-pointer", onClick: b => _.opened = !_.opened }, [e("div", il, [r(te, { name: _.opened ? "chevron-down" : "chevron-right", class: "h-4 text-ink-gray-5" }, null, 8, ["name"]), e("div", rl, B(_.title), 1)])], 8, sl), Pe(e("div", cl, [(l(!0), o(F, null, H(_.subArticles, b => (l(), o("div", { key: b.name, class: "group flex items-center justify-between gap-2 p-1.5 hover:bg-surface-gray-1 rounded cursor-pointer", onClick: () => d(b.name) }, [e("div", dl, [r(te, { name: "file-text", class: "h-4 text-ink-gray-5" }), e("div", pl, B(b.title), 1)]), r(te, { name: "arrow-up-right", class: "h-4 hidden group-hover:flex text-ink-gray-5" })], 8, ul))), 128))], 512), [[Ze, _.opened]])]))), 128))])])) } }, gl = { class: "flex items-center justify-between px-2 py-1.5" }, fl = { class: "text-base font-medium" }, _l = { class: "flex gap-1" }, vl = { class: "h-full overflow-hidden flex flex-col" }, hl = { class: "flex flex-col gap-1.5" }, kl = ["onClick"], Cl = { class: "text-base" }, bl = { __name: "HelpModal", props: be({ appName: { type: String, default: "frappecrm" }, title: { type: String, default: "Frappe CRM" }, logo: { type: Object, required: !0 }, afterSkip: { type: Function, default: () => { } }, afterSkipAll: { type: Function, default: () => { } }, afterReset: { type: Function, default: () => { } }, afterResetAll: { type: Function, default: () => { } }, docsLink: { type: String, default: "https://docs.frappe.io/crm" } }, { modelValue: {}, modelModifiers: {}, articles: {}, articlesModifiers: {} }), emits: ["update:modelValue", "update:articles"], setup(i) { const n = i, { syncStatus: c, resetAll: s, isOnboardingStepsCompleted: a } = fe(n.appName), u = ge(i, "modelValue"), p = ge(i, "articles"), d = N(() => { if (!a.value && !W.value) return "Getting started"; if (W.value) return "Help center" }), h = N(() => [{ icon: he, label: "Reset onboarding steps", onClick: _, condition: () => W.value && a.value }].filter(m => m.condition())), f = N(() => [{ icon: tt, label: "Help centre", onClick: () => { c(), W.value = !0 }, condition: !a.value && !W.value }, { icon: he, label: "Getting started", onClick: () => W.value = !1, condition: W.value && !a.value }].filter(m => m.condition)); function _() { s(), a.value = !1, W.value = !1 } return Le(() => { a.value && (W.value = !0) }), (b, m) => Pe((l(), o("div", { class: q(["fixed z-50 right-0 w-80 h-[calc(100%_-_80px)] text-ink-gray-9 m-5 mt-[62px] p-3 flex gap-2 flex-col justify-between rounded-lg bg-surface-modal shadow-2xl", { "top-[calc(100%_-_120px)] border": t(Z) }]), onClick: m[3] || (m[3] = me(() => { }, ["stop"])) }, [e("div", gl, [e("div", fl, B(d.value), 1), e("div", _l, [h.value.length ? (l(), w(Xe, { key: 0, options: h.value }, { default: C(() => [r(O, { variant: "ghost", icon: "more-horizontal" })]), _: 1 }, 8, ["options"])) : k("", !0), r(O, { onClick: m[0] || (m[0] = g => Z.value = !t(Z)), variant: "ghost" }, { default: C(() => [(l(), w(ie(t(Z) ? On : Tn), { class: "h-3.5" }))]), _: 1 }), r(O, { variant: "ghost", onClick: m[1] || (m[1] = g => u.value = !1) }, { default: C(() => [r(te, { name: "x", class: "h-3.5" })]), _: 1 })])]), e("div", vl, [!t(a) && !t(W) ? (l(), w(tl, { key: 0, title: i.title, logo: i.logo, afterSkip: i.afterSkip, afterSkipAll: i.afterSkipAll, afterReset: i.afterReset, afterResetAll: i.afterResetAll, appName: i.appName }, null, 8, ["title", "logo", "afterSkip", "afterSkipAll", "afterReset", "afterResetAll", "appName"])) : t(W) ? (l(), w(ml, { key: 1, modelValue: p.value, "onUpdate:modelValue": m[2] || (m[2] = g => p.value = g), docsLink: i.docsLink }, null, 8, ["modelValue", "docsLink"])) : k("", !0)]), (l(!0), o(F, null, H(f.value, g => (l(), o("div", hl, [e("div", { class: "w-full flex gap-2 items-center hover:bg-surface-gray-1 text-ink-gray-8 rounded px-2 py-1.5 cursor-pointer", onClick: g.onClick }, [(l(), w(ie(g.icon), { class: "h-4" })), e("div", Cl, B(g.label), 1)], 8, kl)]))), 256))], 2)), [[Ze, u.value]]) } }, Al = { key: 0, class: "flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base" }, xl = { key: 0, class: "inline-flex text-ink-gray-9 gap-2" }, yl = { class: "flex flex-col text-p-sm gap-0.5" }, wl = { class: "text-ink-gray-7" }, $l = { key: 1, class: "flex flex-col gap-1" }, El = { class: "flex items-center justify-between gap-1" }, Il = { class: "flex items-center gap-2 shrink-0" }, Sl = { __name: "GettingStartedBanner", props: { isSidebarCollapsed: { type: Boolean, default: !1 }, appName: { type: String, default: "frappecrm" } }, setup(i) { const n = i, { stepsCompleted: c, totalSteps: s, isOnboardingStepsCompleted: a } = fe(n.appName), u = () => { Z.value = !1, se.value = !0 }; return (p, d) => i.isSidebarCollapsed ? t(c) != t(s) ? (l(), w(O, { key: 1, onClick: u }, { default: C(() => [r(he, { class: "h-4 my-0.5 shrink-0" })]), _: 1 })) : k("", !0) : (l(), o("div", Al, [t(c) != t(s) ? (l(), o("div", xl, [r(he, { class: "h-4 my-0.5 shrink-0" }), e("div", yl, [d[1] || (d[1] = e("div", { class: "font-medium" }, B("Getting started"), -1)), e("div", wl, B(`${t(c)}/${t(s)} steps`), 1)])])) : (l(), o("div", $l, [e("div", El, [e("div", Il, [r(he, { class: "h-4 my-0.5" }), d[2] || (d[2] = e("div", { class: "text-ink-gray-9 font-medium" }, B("You are all set"), -1))]), r(te, { name: "x", class: "h-4 cursor-pointer", onClick: d[0] || (d[0] = () => { W.value = !0, a.value = !0 }) })]), d[3] || (d[3] = e("div", { class: "text-p-sm text-ink-gray-7" }, B("All steps are completed successfully"), -1))])), t(c) != t(s) ? (l(), w(O, { key: 2, label: t(c) == 0 ? "Start now" : "Continue", theme: "blue", onClick: u }, { prefix: C(() => [r(te, { name: "chevrons-right", class: "size-4" })]), _: 1 }, 8, ["label"])) : k("", !0)])) } }, Bl = { class: "flex flex-col gap-2 text-ink-gray-9 text-base" }, Ll = { key: 0 }, Vl = { key: 1, class: "w-full rounded", controls: "", autoplay: "", muted: "" }, Ql = ["src"], Ml = { __name: "IntermediateStepModal", props: be({ currentStep: { type: Object, default: { title: "Title", message: "Message", videoURL: "", buttonLabel: "Button Label", onClick: () => { } } }, dialogOptions: { type: Object, default: () => ({}) } }, { modelValue: {}, modelModifiers: {} }), emits: ["update:modelValue"], setup(i) { const n = i, c = ge(i, "modelValue"), s = N(() => n.dialogOptions && Object.keys(n.dialogOptions).length ? n.dialogOptions : { title: n.currentStep.title, size: "2xl", actions: [{ label: n.currentStep.buttonLabel, variant: "solid", onClick: n.currentStep.onClick }] }); return (a, u) => (l(), w(t(ke), { modelValue: c.value, "onUpdate:modelValue": u[0] || (u[0] = p => c.value = p), options: s.value }, { "boday-header": C(() => [_e(a.$slots, "body-header")]), "body-content": C(() => [_e(a.$slots, "default", {}, () => [e("div", Bl, [i.currentStep.message ? (l(), o("div", Ll, B(i.currentStep.message), 1)) : k("", !0), i.currentStep.videoURL ? (l(), o("video", Vl, [e("source", { src: i.currentStep.videoURL, type: "video/mp4" }, null, 8, Ql), u[1] || (u[1] = le(" Your browser does not support the video tag. "))])) : k("", !0)])])]), actions: C(() => [_e(a.$slots, "actions")]), _: 3 }, 8, ["modelValue", "options"])) } }, Rl = {}, Dl = { width: "17", height: "16", viewBox: "0 0 17 16", fill: "none", xmlns: "http://www.w3.org/2000/svg" }; function Fl(i, n) { return l(), o("svg", Dl, n[0] || (n[0] = [e("path", { "fill-rule": "evenodd", "clip-rule": "evenodd", d: "M6.2641 1C5.5758 1 4.97583 1.46845 4.80889 2.1362L3.57555 7.06953C3.33887 8.01625 4.05491 8.93333 5.03077 8.93333H7.50682L6.72168 14.4293C6.68838 14.6624 6.82229 14.8872 7.04319 14.9689C7.26408 15.0507 7.51204 14.9671 7.63849 14.7684L13.2161 6.00354C13.6398 5.33782 13.1616 4.46667 12.3725 4.46667H9.59038L10.3017 1.62127C10.3391 1.4719 10.3055 1.31365 10.2108 1.19229C10.116 1.07094 9.97063 1 9.81666 1H6.2641ZM5.77903 2.37873C5.83468 2.15615 6.03467 2 6.2641 2H9.17627L8.46492 4.8454C8.42758 4.99477 8.46114 5.15302 8.55589 5.27437C8.65064 5.39573 8.79602 5.46667 8.94999 5.46667H12.3725L8.0395 12.2757L8.5783 8.50404C8.5988 8.36056 8.55602 8.21523 8.46105 8.10573C8.36608 7.99623 8.22827 7.93333 8.08332 7.93333H5.03077C4.70548 7.93333 4.4668 7.62764 4.5457 7.31207L5.77903 2.37873Z", fill: "currentColor" }, null, -1)])) } const Te = re(Rl, [["render", Fl]]), jl = { key: 0, class: "flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base" }, Tl = { class: "flex flex-col gap-1" }, Ul = { class: "inline-flex text-ink-gray-9 gap-2 items-center font-medium" }, Nl = "Upgrade to a paid plan for uninterrupted services", Ue = { __name: "TrialBanner", props: { isSidebarCollapsed: { type: Boolean, default: !1 }, afterUpgrade: { type: Function, default: () => { } } }, setup(i) { const n = i, c = S(0), s = S(!1), a = S("https://frappecloud.com"), u = S(""), p = N(() => c.value > 1 ? "Trial ends in " + c.value + " days" : "Trial ends tomorrow"); ae({ url: "frappe.integrations.frappe_providers.frappecloud_billing.current_site_info", cache: "current_site_info_data", auto: !0, onSuccess: f => { c.value = d(f.trial_end_date), a.value = f.base_url, u.value = f.site_name, s.value = f.setup_complete && f.plan.is_trial_plan && c.value > 0 } }); function d(f) { if (!f) return 0; f = new Date(f); const b = f - new Date; return Math.ceil(b / (1e3 * 60 * 60 * 24)) } function h() { var f; window.open(`${a.value}/dashboard/sites/${u.value}`, "_blank"), (f = n.afterUpgrade) == null || f.call(n) } return (f, _) => !i.isSidebarCollapsed && s.value ? (l(), o("div", jl, [e("div", Tl, [e("div", Ul, [r(te, { class: "h-4", name: "info" }), le(" " + B(p.value), 1)]), e("div", { class: "text-ink-gray-7 text-p-sm" }, B(Nl))]), r(t(O), { label: "Upgrade plan", theme: "blue", onClick: h }, { prefix: C(() => [r(Te, { class: "size-4" })]), _: 1 })])) : i.isSidebarCollapsed && s.value ? (l(), w(t(O), { key: 1, onClick: h }, { default: C(() => [r(Te, { class: "h-4 my-0.5 shrink-0" })]), _: 1 })) : k("", !0) } }, Hl = {}, Ol = { class: "flex border-b pr-5" }; function Pl(i, n) { return l(), o("div", Ol, n[0] || (n[0] = [e("div", { id: "app-header", class: "flex-1 w-full" }, null, -1)])) } const Zl = re(Hl, [["render", Pl]]), U = Ve({ doctype: "HD Agent", fields: ["name", "user_image", "agent_name", "is_active"], cache: ["hd_agent_list"], start: 0, pageLength: 10, orderBy: "creation desc", auto: !X.value }), de = S("Active"), ce = S(!1), zl = () => { const i = S(""), n = Ce({}); ve(i, s => { U.filters = { agent_name: ["like", `%${s}%`], ...n }, s || (U.filters = { ...n }, U.start = 0, U.pageLength = 10), U.reload() }), ve(n, s => { U.filters = { ...U.filters, ...s }, U.start = 0, U.pageLength = 10, U.reload() }, { deep: !0 }), ve(de, s => { s === "Active" ? U.filters = { ...U.filters, is_active: 1 } : s === "Inactive" ? U.filters = { ...U.filters, is_active: 0 } : U.filters = { ...U.filters, is_active: ["in", [0, 1]] }, U.start = 0, U.pageLength = 10, U.reload() }, { immediate: !0 }); async function c(s, a) { await ae({ url: "frappe.client.set_value", params: { doctype: "HD Agent", name: s, fieldname: "is_active", value: a } }).submit() } return { search: i, agents: U, filters: n, updateAgent: c } }, Jl = { class: "lucide lucide-image-up", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function ql(i, n) { return l(), o("svg", Jl, n[0] || (n[0] = [e("path", { d: "M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21" }, null, -1), e("path", { d: "m14 19.5 3-3 3 3" }, null, -1), e("path", { d: "M17 22v-5.5" }, null, -1), e("circle", { cx: "9", cy: "9", r: "2" }, null, -1)])) } const Gl = V({ name: "lucide-image-up", render: ql }), Wl = { class: "lucide lucide-mail", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function Yl(i, n) { return l(), o("svg", Wl, n[0] || (n[0] = [e("rect", { width: "20", height: "16", x: "2", y: "4", rx: "2" }, null, -1), e("path", { d: "m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" }, null, -1)])) } const nt = V({ name: "lucide-mail", render: Yl }), Kl = { class: "space-y-3" }, Xl = { key: 0, class: "flex max-h-[300px] min-h-[100px] flex-col overflow-y-auto rounded border bg-gray-100 px-2" }, ea = { class: "flex flex-wrap gap-2 py-2" }, ta = ["title"], na = { class: "ml-2 text-base" }, la = ["onClick"], aa = { class: "flex justify-end items-center" }, oa = { __name: "AddNewAgentsDialog", props: { show: Boolean }, emits: ["close", "update:modelValue"], setup(i, { emit: n }) { const c = n, s = S(""), a = S([]), u = S(!1), { updateOnboardingStep: p } = fe("helpdesk"), { isManager: d } = Qe(), h = $ => /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test($), f = $ => { if ($ = $.replaceAll(" ", ""), $ == "") { document.getElementById("searchInput").value = ""; return } const L = $, P = $.split(","); let A = !1; u.value = !1, P.forEach(y => { h(y) && (P.length > 1 || L.includes(",") ? (_(y), A = !0) : u.value = !0) }), A && g() }, _ = $ => { a.value = [...new Set([...a.value, $])] }, b = $ => { a.value = a.value.filter(L => L !== $) }, m = () => { a.value = [] }, g = () => { u.value = !1, s.value = ""; const $ = document.getElementById("searchInput"); $.value = "", $.focus() }, v = () => { s.value = "", a.value = [], c("close") }, M = ae({ url: "terrasuitehelpdesk.api.agent.sent_invites", onSuccess: $ => { u.value = !1, s.value = "", a.value = [], d && p("invite_agents"), J.success("Invites sent successfully!"), v() } }), E = () => { M.submit({ emails: a.value }) }; return ($, L) => { const P = j("Button"); return l(), w(t(ke), { options: { title: "Add Agents" }, "model-value": i.show, "onUpdate:modelValue": L[4] || (L[4] = A => $.$emit("update:modelValue", A)), onClose: L[5] || (L[5] = A => v()) }, St({ "body-content": C(() => [e("div", Kl, [e("form", { onSubmit: L[3] || (L[3] = me((...A) => $.onSubmit && $.onSubmit(...A), ["prevent"])), class: "flex flex-row items-center space-x-2" }, [r(t(Bt), { id: "searchInput", class: "w-full", type: "text", modelValue: s.value, "onUpdate:modelValue": L[0] || (L[0] = A => s.value = A), placeholder: "Type emails", onInput: L[1] || (L[1] = A => f(A)) }, null, 8, ["modelValue"]), r(P, { appearance: "primary", type: "submit", disabled: !u.value, onClick: L[2] || (L[2] = () => { _(s.value), g() }) }, { default: C(() => L[6] || (L[6] = [le(" Add ")])), _: 1, __: [6] }, 8, ["disabled"])], 32), a.value.length ? (l(), o("div", Xl, [e("ul", ea, [(l(!0), o(F, null, H(a.value.slice().reverse(), A => (l(), o("li", { class: "flex items-center space-x-2 rounded bg-white p-1 shadow", key: A, title: A }, [e("span", na, B(A), 1), e("button", { class: "grid h-4 w-4 place-items-center rounded text-gray-700 hover:bg-gray-300", onClick: y => b(A) }, [r(t(te), { class: "w-3", name: "x" })], 8, la)], 8, ta))), 128))])])) : k("", !0)])]), _: 2 }, [a.value.length ? { name: "actions", fn: C(() => [e("div", aa, [r(P, { disabled: a.value.length == 0, appearance: "primary", onClick: E, class: "mr-2", variant: "solid", loading: t(M).loading }, { default: C(() => L[7] || (L[7] = [le("Send Invites ")])), _: 1, __: [7] }, 8, ["disabled", "loading"]), r(P, { onClick: m }, { default: C(() => L[8] || (L[8] = [le(" Clear All ")])), _: 1, __: [8] })])]), key: "0" } : void 0]), 1032, ["model-value"]) } } }, sa = { class: "flex items-center space-x-3 w-4/5" }, ia = { class: "flex items-center gap-2" }, ra = { class: "text-base" }, ca = { class: "text-base text-ink-gray-6 mt-1" }, lt = z({ __name: "AgentCard", props: { agent: { type: Object, required: !0 }, showStatus: { type: Boolean, default: !1 } }, setup(i) { return (n, c) => { const s = j("Badge"); return l(), o("div", { class: q(["flex items-center justify-between py-2", n.$attrs]) }, [e("div", sa, [r(t(Se), { image: i.agent.user_image, label: i.agent.agent_name, size: "xl" }, null, 8, ["image", "label"]), e("div", null, [e("div", ia, [e("p", ra, B(i.agent.agent_name), 1), i.showStatus ? (l(), w(s, { key: 0, label: "Inactive", theme: "gray", class: q(i.showStatus && !i.agent.is_active ? "opacity-100" : "opacity-0"), variant: "subtle" }, null, 8, ["class"])) : k("", !0)]), e("div", ca, B(i.agent.name), 1)])]), _e(n.$slots, "right")], 2) } } }), ua = { class: "flex items-center justify-between mb-4" }, da = { class: "flex item-center space-x-2" }, pa = ["onClick"], ma = { class: "flex items-center justify-between flex-1" }, ga = { class: "whitespace-nowrap" }, fa = { key: 0, class: "flex mt-28 justify-between w-full h-full" }, _a = { key: 1, class: "flex mt-28 justify-between w-full h-full" }, va = { key: 2, class: "overflow-y-auto w-full hide-scrollbar" }, ha = { class: "flex justify-center" }, ka = z({ __name: "Agents", setup(i) { const { getUserRole: n, updateUserRoleCache: c } = ze(), { isManager: s } = Qe(), a = zl(), u = a.search, p = a.agents; function d(m) { const g = n(m), v = [{ label: "Agent", component: M => h({ role: "Agent", active: M.active, selected: g === "Agent", onClick: () => { f(m, "Agent") } }) }]; return s && v.unshift({ label: "Manager", component: M => h({ role: "Manager", active: M.active, selected: g === "Manager", onClick: () => { f(m, "Manager") } }) }), v } function h({ active: m, role: g, onClick: v, selected: M }) { return ee("button", { class: [m ? "bg-surface-gray-2" : "text-ink-gray-7", "group flex w-full justify-between items-center rounded-md px-2 py-2 text-base"], onClick: M ? null : v }, [ee("span", { class: "whitespace-nowrap" }, g), M ? ee(Lt, { class: ["h-4 w-4 shrink-0 text-ink-gray-7"], "aria-hidden": !0 }) : null]) } function f(m, g) { n(m) !== g && pe("terrasuitehelpdesk.helpdesk.doctype.hd_agent.hd_agent.update_agent_role", { user: m, new_role: g }).then(() => { c(m, g), J.success(`Role updated to ${g}`) }) } function _(m) { let g = a.filters; return [{ label: "Disable Agent", icon: "x-circle", onClick: async () => { await a.updateAgent(m.name, 0), p.reload({ ...g, search: u.value }) }, condition: () => m.is_active }, { label: "Enable Agent", icon: "check-circle", onClick: async () => { await a.updateAgent(m.name, 1), p.reload({ ...g, search: u.value }) }, condition: () => !m.is_active }] } const b = [{ label: "All", onClick: () => { a.filters.is_active = ["in", [0, 1]], de.value = "All" } }, { label: "Active", onClick: () => { a.filters.is_active = ["=", 1], de.value = "Active" } }, { label: "Inactive", onClick: () => { a.filters.is_active = ["=", 0], de.value = "Inactive" } }]; return (m, g) => { var A, y; const v = Ie, M = j("FeatherIcon"), E = j("Button"), $ = rn, L = Ee, P = oa; return l(), o(F, null, [e("div", { class: q(m.$attrs.class) }, [e("div", ua, [g[5] || (g[5] = e("h1", { class: "text-lg font-semibold" }, "Agents", -1)), e("div", da, [r(t(qe), { modelValue: t(u), "onUpdate:modelValue": g[0] || (g[0] = x => Je(u) ? u.value = x : null), placeholder: "Search", type: "text", debounce: 300 }, { prefix: C(() => [r(v, { class: "h-4 w-4 text-gray-500" })]), _: 1 }, 8, ["modelValue"]), r($, { options: b, placement: "right" }, { default: C(({ open: x }) => [r(E, { label: t(de), class: "flex items-center justify-between w-[90px]" }, { suffix: C(() => [r(M, { name: x ? "chevron-up" : "chevron-down", class: "h-4" }, null, 8, ["name"])]), _: 2 }, 1032, ["label"])]), item: C(({ item: x, active: D }) => [e("button", { class: q(["group flex text-ink-gray-6 gap-4 h-7 w-full justify-between items-center rounded px-2 text-base", { "bg-surface-gray-3": D }]), onClick: x.onClick }, [e("div", ma, [e("span", ga, B(x.label), 1), t(de) === x.label ? (l(), w(M, { key: 0, name: "check", class: "size-4 text-ink-gray-7" })) : k("", !0)])], 10, pa)]), _: 1 }), r(E, { onClick: g[1] || (g[1] = () => ce.value = !t(ce)), label: "New", variant: "solid" }, { prefix: C(() => [r(L, { class: "h-4 w-4 stroke-1.5" })]), _: 1 })])]), t(p).loading ? (l(), o("div", fa, [r(E, { loading: t(p).loading, variant: "ghost", class: "w-full", size: "2xl" }, null, 8, ["loading"])])) : k("", !0), !t(p).loading && !((A = t(p).data) != null && A.length) ? (l(), o("div", _a, g[6] || (g[6] = [e("p", { class: "text-sm text-gray-500 w-full flex justify-center" }, " No agents found ", -1)]))) : k("", !0), !t(p).loading && ((y = t(p).data) != null && y.length) ? (l(), o("div", va, [(l(!0), o(F, null, H(t(p).data, (x, D) => (l(), o("div", { key: x.agent_name }, [r(lt, { agent: x, "show-status": !0, class: q(D !== t(p).data.length - 1 && "border-b ") }, { right: C(() => [t(s) ? (l(), w($, { key: 0, class: "w-1/5 flex justify-end items-center", options: d(x.name), label: t(n)(x.name), button: { label: t(n)(x.name), iconRight: "chevron-down" }, placement: "right" }, null, 8, ["options", "label", "button"])) : k("", !0), (l(), w($, { options: _(x), placement: "right", key: x, class: "ml-2" }, { default: C(() => [r(E, null, { icon: C(() => [r(t(We), { class: "h-4 w-4" })]), _: 1 })]), _: 2 }, 1032, ["options"]))]), _: 2 }, 1032, ["agent", "class"])]))), 128)), e("div", ha, [!t(p).loading && t(p).hasNextPage ? (l(), w(E, { key: 0, class: "mt-3.5 p-2", onClick: g[2] || (g[2] = () => t(p).next()), loading: t(p).loading, label: "Load More", "icon-left": "refresh-cw" }, null, 8, ["loading"])) : k("", !0)])])) : k("", !0)], 2), r(P, { onClose: g[3] || (g[3] = x => ce.value = !1), modelValue: t(ce), show: t(ce), "onUpdate:modelValue": g[4] || (g[4] = x => ce.value = x) }, null, 8, ["modelValue", "show"])], 64) } } }), Ca = { class: "flex flex-col gap-4" }, ba = { class: "flex flex-col gap-2" }, Aa = { class: "text-sm text-gray-600" }, xa = { class: "flex gap-4 items-center" }, ya = { key: 2 }, wa = z({ __name: "Branding", setup(i) { var _; const n = Ge(), c = ae({ url: "frappe.client.get_value", cache: !0, params: { doctype: "Website Settings", fieldname: "favicon" }, onSuccess(b) { s.brandFavicon = b.favicon }, auto: !0 }), s = Ce({ brandLogo: n.brandLogo, brandFavicon: ((_ = c.data) == null ? void 0 : _.favicon) || "" }), a = Ce({ logoLoading: !1, faviconLoading: !1 }), u = N(() => [{ title: "Brand Logo", image: s.brandLogo, doctype: "HD Settings", fieldname: "brand_logo", loading: a.logoLoading }, { title: "Brand Favicon", image: s.brandFavicon, doctype: "Website Settings", fieldname: "favicon", loading: a.faviconLoading }]), p = ae({ url: "frappe.client.set_value", debounce: 1e3, onSuccess(b) { b.doctype === "HD Settings" ? h(b.brand_logo) : f(b.favicon) }, onError() { J.error("Failed to update, please try again"), a.logoLoading = !1, a.faviconLoading = !1 } }); function d(b, m, g) { p.submit({ doctype: m, name: m, fieldname: g, value: b }), m === "HD Settings" ? a.logoLoading = !0 : a.faviconLoading = !0 } function h(b) { s.brandLogo = b, a.logoLoading = !1, J.success("Brand logo updated") } function f(b) { s.brandFavicon = b, a.faviconLoading = !1, J.success("Favicon updated, please refresh the page to see the changes") } return (b, m) => { const g = j("Button"); return l(), o("div", Ca, [m[0] || (m[0] = e("div", { class: "flex items-center justify-between" }, [e("h1", { class: "text-lg font-semibold py-[5px]" }, "Customise your Helpdesk")], -1)), (l(!0), o(F, null, H(u.value, v => (l(), o("div", ba, [e("p", Aa, B(v.title), 1), e("div", xa, [v.image && !v.loading ? (l(), w(t(Se), { key: 0, size: "3xl", image: v.image }, null, 8, ["image"])) : k("", !0), v.image ? (l(), o("div", ya, [r(g, { label: "Remove", onClick: M => d("", v.doctype, v.fieldname), iconLeft: "trash", loading: v.loading }, null, 8, ["onClick", "loading"])])) : (l(), w(t(cn), { key: 1, fileTypes: ["image/*"], onSuccess: M => { d(M.file_url, v.doctype, v.fieldname) } }, { default: C(({ openFileSelector: M }) => [r(g, { onClick: E => M(), iconLeft: "upload", label: "Upload Image", loading: v.loading }, null, 8, ["onClick", "loading"])]), _: 2 }, 1032, ["onSuccess"]))])]))), 256))]) } } }), $a = { class: "lucide lucide-circle-alert", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function Ea(i, n) { return l(), o("svg", $a, n[0] || (n[0] = [e("circle", { cx: "12", cy: "12", r: "10" }, null, -1), e("line", { x1: "12", x2: "12", y1: "8", y2: "12" }, null, -1), e("line", { x1: "12", x2: "12.01", y1: "16", y2: "16" }, null, -1)])) } const $e = V({ name: "lucide-circle-alert", render: Ea }), at = "/assets/helpdesk/desk/assets/gmail-6497f877.png", ot = "/assets/helpdesk/desk/assets/outlook-e028ee9b.png", st = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwMAAALUBAMAAAClQPMzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAACRQTFRFR3BMNqzpdMXvXb3tr+f3o+P1AJ/ZGoPjALPjmeH1dc3uBqfjM5e/jQAAAAZ0Uk5TAPVwwVLTgnc47wAABIBJREFUeNrt1rEJwlAYhdEHNpZa2UpwAxewcAXtbdJYpQo4gATsBVdwAOcTd/DyknC+9zY4XPhLkSRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJGmGL/cTazo5gOWR69KFWCBAgQIAAAQIECBAgmArBHYEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAMHfO4U6X9tP4reb9aX77/v9rqtH8Ar1bEOl1oWgNsGAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAjqEfShbu9QTajD/AhS8yqzCwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIKheE2p3DFUkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZLG2Bet4fvU2eVggAAAAABJRU5ErkJggg==", it = "/assets/helpdesk/desk/assets/sparkpost-3d6653ba.webp", rt = "/assets/helpdesk/desk/assets/yahoo-bf2216d3.png", ct = "/assets/helpdesk/desk/assets/yandex-5e1e6be8.png", ut = "/assets/helpdesk/desk/assets/frappe-mail-579163d7.svg", dt = [{ label: "Account Name", name: "email_account_name", type: "text", placeholder: "Support / Sales" }, { label: "Email ID", name: "email_id", type: "email", placeholder: "johndoe@example.com" }], pt = [{ label: "Enable Incoming", name: "enable_incoming", type: "checkbox", description: "If enabled, tickets can be created from the incoming emails on this account." }, { label: "Enable Outgoing", name: "enable_outgoing", type: "checkbox", description: "If enabled, outgoing emails can be sent from this account." }, { label: "Default Incoming", name: "default_incoming", type: "checkbox", description: "If enabled, all replies to your company (eg: replies@yourcomany.com) will come to this account. Note: Only one account can be default incoming." }, { label: "Default Outgoing", name: "default_outgoing", type: "checkbox", description: "If enabled, all outgoing emails will be sent from this account. Note: Only one account can be default outgoing." }], mt = [...dt, { label: "Password", name: "password", type: "password", placeholder: "********" }], gt = [...dt, { label: "Frappe Mail Site", name: "frappe_mail_site", type: "text", placeholder: "https://frappemail.com" }, { label: "API Key", name: "api_key", type: "text", placeholder: "********" }, { label: "API Secret", name: "api_secret", type: "password", placeholder: "********" }], ft = [{
	name: "GMail", icon: at, info: `Setting up GMail requires you to enable two factor authentication
		  and app specific passwords. Read more`, link: "https://support.google.com/accounts/answer/185833", custom: !1
}, {
	name: "Outlook", icon: ot, info: `Setting up Outlook requires you to enable two factor authentication
		  and app specific passwords. Read more`, link: "https://support.microsoft.com/en-us/account-billing/how-to-get-and-use-app-passwords-5896ed9b-4263-e681-128a-a6f2979a7944", custom: !1
}, {
	name: "Sendgrid", icon: st, info: `Setting up Sendgrid requires you to enable two factor authentication
		  and app specific passwords. Read more `, link: "https://sendgrid.com/docs/ui/account-and-settings/two-factor-authentication/", custom: !1
}, {
	name: "SparkPost", icon: it, info: `Setting up SparkPost requires you to enable two factor authentication
		  and app specific passwords. Read more `, link: "https://support.sparkpost.com/docs/my-account-and-profile/enabling-two-factor-authentication", custom: !1
}, {
	name: "Yahoo", icon: rt, info: `Setting up Yahoo requires you to enable two factor authentication
		  and app specific passwords. Read more `, link: "https://help.yahoo.com/kb/SLN15241.html", custom: !1
}, {
	name: "Yandex", icon: ct, info: `Setting up Yandex requires you to enable two factor authentication
		  and app specific passwords. Read more `, link: "https://yandex.com/support/id/authorization/app-passwords.html", custom: !1
}, { name: "Frappe Mail", icon: ut, info: "Setting up Frappe Mail requires you to have an API key and API Secret of your email account. Read more ", link: "https://github.com/frappe/mail", custom: !0 }], _t = { GMail: at, Outlook: ot, Sendgrid: st, SparkPost: it, Yahoo: rt, Yandex: ct, "Frappe Mail": ut }; function vt(i, n) { if (!i.email_account_name) return "Account name is required"; if (!i.email_id) return "Email ID is required"; if (!Vt(i.email_id)) return "Invalid email ID"; if (!n && !i.password) return "Password is required"; if (n) { if (!i.api_key) return "API Key is required"; if (!i.api_secret) return } return "" } const Ia = ["src"], Sa = { key: 0, class: "text-center text-p-xs text-gray-700" }, Me = z({ __name: "EmailProviderIcon", props: { serviceName: { default: "" }, logo: { default: "" }, selected: { type: Boolean, default: !1 } }, setup(i) { return (n, c) => (l(), o(F, null, [e("div", { class: q(["flex h-10 w-10 cursor-pointer items-center justify-center rounded-xl bg-gray-100 hover:bg-gray-200", { "ring-2 ring-blue-500": n.selected }]) }, [e("img", { src: n.logo, class: "h-6 w-6" }, null, 8, Ia)], 2), n.serviceName ? (l(), o("p", Sa, B(n.serviceName), 1)) : k("", !0)], 64)) } }), Ba = { class: "flex h-full flex-col gap-4" }, La = { class: "flex flex-wrap items-center gap-4" }, Va = ["onClick"], Qa = { key: 0, class: "flex flex-col gap-4" }, Ma = { class: "flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200" }, Ra = { class: "text-wrap text-xs text-gray-700" }, Da = ["href"], Fa = { class: "flex flex-col gap-4" }, ja = { class: "grid grid-cols-1 gap-4" }, Ta = { class: "grid grid-cols-2 gap-4" }, Ua = { class: "text-gray-500 text-p-sm" }, Na = { key: 1, class: "mt-auto flex justify-between" }, Ha = z({ __name: "EmailAdd", emits: ["update:step"], setup(i, { emit: n }) { const c = n, { updateOnboardingStep: s } = fe("helpdesk"), a = Ce({ service: "", email_account_name: "", email_id: "", password: "", api_key: "", api_secret: "", frappe_mail_site: "", enable_incoming: !1, enable_outgoing: !1, default_incoming: !1, default_outgoing: !1 }), u = S(null), p = N(() => u.value.custom ? gt : mt); function d(b) { u.value = b, a.service = b.name } const h = ae({ url: "terrasuitehelpdesk.api.settings.create_email_account", makeParams: b => ({ ...b }), onSuccess: () => { J.success("Email account created"), c("update:step", "email-list"), s("setup_email_account") }, onError: () => { f.value = "Failed to create email account, Invalid credentials" } }), f = S(); function _() { f.value = vt(a, u.value.custom), !f.value && h.submit({ data: a }) } return (b, m) => { const g = j("FormControl"), v = j("ErrorMessage"), M = j("Button"); return l(), o("div", Ba, [m[2] || (m[2] = e("div", { role: "heading", "aria-level": "1", class: "flex flex-col gap-1" }, [e("h5", { class: "text-lg font-semibold pt-[5px]" }, "Setup Email"), e("p", { class: "text-sm text-gray-600" }, " Choose the email service provider you want to configure. ")], -1)), e("div", La, [(l(!0), o(F, null, H(t(ft), E => { var $; return l(), o("div", { key: E.name, class: "min-w-3 flex flex-col items-center gap-1", onClick: L => d(E) }, [r(Me, { "service-name": E.name, logo: E.icon, selected: (($ = u.value) == null ? void 0 : $.name) === (E == null ? void 0 : E.name) }, null, 8, ["service-name", "logo", "selected"])], 8, Va) }), 128))]), u.value ? (l(), o("div", Qa, [e("div", Ma, [r(t($e), { class: "h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500" }), e("div", Ra, [le(B(u.value.info) + " ", 1), e("a", { href: u.value.link, target: "_blank", class: "text-blue-500 underline" }, "here", 8, Da), m[1] || (m[1] = le(" . "))])]), e("div", Fa, [e("div", ja, [(l(!0), o(F, null, H(p.value, E => (l(), o("div", { key: E.name, class: "flex flex-col gap-1" }, [r(g, { modelValue: a[E.name], "onUpdate:modelValue": $ => a[E.name] = $, label: E.label, name: E.name, type: E.type, placeholder: E.placeholder }, null, 8, ["modelValue", "onUpdate:modelValue", "label", "name", "type", "placeholder"])]))), 128))]), e("div", Ta, [(l(!0), o(F, null, H(t(pt), E => (l(), o("div", { key: E.name, class: "flex flex-col gap-1" }, [r(g, { modelValue: a[E.name], "onUpdate:modelValue": $ => a[E.name] = $, label: E.label, name: E.name, type: E.type }, null, 8, ["modelValue", "onUpdate:modelValue", "label", "name", "type"]), e("p", Ua, B(E.description), 1)]))), 128))]), f.value ? (l(), w(v, { key: 0, class: "ml-1", message: f.value }, null, 8, ["message"])) : k("", !0)])])) : k("", !0), u.value ? (l(), o("div", Na, [r(M, { label: "Back", theme: "gray", variant: "outline", disabled: t(h).loading, onClick: m[0] || (m[0] = E => c("update:step", "email-list")) }, null, 8, ["disabled"]), r(M, { label: "Create", variant: "solid", loading: t(h).loading, onClick: _ }, null, 8, ["loading"])])) : k("", !0)]) } } }), Oa = { class: "flex justify-between items-center border-gray-200 p-2 pl-0 cursor-pointer" }, Pa = { class: "flex justify-between items-center gap-2" }, Za = { class: "text-gray-700 font-semibold" }, za = { class: "text-sm text-gray-500" }, Ja = z({ __name: "EmailAccountCard", props: { emailAccount: {} }, setup(i) { const n = i, c = N(() => n.emailAccount.default_incoming && n.emailAccount.default_outgoing ? ["Default Sending and Inbox", n.emailAccount.enable_incoming && n.emailAccount.enable_outgoing ? "blue" : "gray"] : n.emailAccount.default_incoming ? ["Default Inbox", n.emailAccount.enable_incoming ? "blue" : "gray"] : n.emailAccount.default_outgoing ? ["Default Sending", n.emailAccount.enable_outgoing ? "blue" : "gray"] : ["Inbox", n.emailAccount.enable_incoming ? "blue" : "gray"]); return (s, a) => { const u = j("Badge"); return l(), o("div", Oa, [e("div", Pa, [r(Me, { logo: t(_t)[s.emailAccount.service] }, null, 8, ["logo"]), e("div", null, [e("p", Za, B(s.emailAccount.email_account_name), 1), e("div", za, B(s.emailAccount.email_id), 1)])]), e("div", null, [r(u, { variant: "subtle", label: c.value[0], theme: c.value[1] }, null, 8, ["label", "theme"])])]) } } }), qa = { class: "flex items-center justify-between" }, Ga = { key: 0, class: "mt-4 divide-y" }, Wa = { key: 1, class: "flex items-center justify-center h-64 text-gray-500" }, Ya = z({ __name: "EmailAccountList", emits: ["update:step"], setup(i, { emit: n }) { const c = n, s = Ve({ doctype: "Email Account", cache: ["Email Accounts"], fields: ["*"], filters: { email_id: ["Not Like", "%example%"] }, pageLength: 10, auto: !0, onSuccess: a => { a.forEach(u => { u.enable_incoming = !!u.enable_incoming, u.enable_outgoing = !!u.enable_outgoing, u.default_incoming = !!u.default_incoming, u.default_outgoing = !!u.default_outgoing }) } }); return (a, u) => { var h; const p = Ee, d = j("Button"); return l(), o("div", null, [e("div", qa, [u[1] || (u[1] = e("h1", { class: "text-lg font-semibold" }, "Email Accounts", -1)), r(d, { label: "Add Account", theme: "gray", variant: "solid", onClick: u[0] || (u[0] = f => c("update:step", "email-add")) }, { prefix: C(() => [r(p, { class: "h-4 w-4" })]), _: 1 })]), !t(s).loading && ((h = t(s).data) != null && h.length) ? (l(), o("div", Ga, [(l(!0), o(F, null, H(t(s).data, f => (l(), o("div", { key: f.name }, [r(Ja, { emailAccount: f, onClick: _ => c("update:step", "email-edit", f) }, null, 8, ["emailAccount", "onClick"])]))), 128))])) : (l(), o("div", Wa, " Please add an email account to continue. "))]) } } }), Ka = { class: "flex h-full flex-col gap-4" }, Xa = { class: "w-fit" }, eo = { class: "flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200" }, to = { class: "text-wrap text-xs text-gray-700" }, no = ["href"], lo = { class: "flex flex-col gap-4" }, ao = { class: "grid grid-cols-1 gap-4" }, oo = { class: "grid grid-cols-2 gap-4" }, so = { class: "text-p-sm text-gray-500" }, io = { class: "mt-auto flex justify-between" }, ro = { class: "flex gap-2" }, co = z({ __name: "EmailEdit", props: { accountData: { default: null } }, emits: ["update:step"], setup(i, { emit: n }) { var L, P, A, y; const c = i, s = n, a = Ce({ email_account_name: c.accountData.email_account_name || "", service: c.accountData.service || "", email_id: c.accountData.email_id || "", api_key: ((L = c.accountData) == null ? void 0 : L.api_key) || null, api_secret: ((P = c.accountData) == null ? void 0 : P.api_secret) || null, password: ((A = c.accountData) == null ? void 0 : A.password) || null, frappe_mail_site: ((y = c.accountData) == null ? void 0 : y.frappe_mail_site) || "", enable_incoming: c.accountData.enable_incoming || !1, enable_outgoing: c.accountData.enable_outgoing || !1, default_outgoing: c.accountData.default_outgoing || !1, default_incoming: c.accountData.default_incoming || !1 }), u = { description: "To know more about setting up email accounts, click", link: "https://docs.erpnext.com/docs/user/manual/en/email-account" }, p = N(() => ft.find(x => x.name === c.accountData.service).custom), d = N(() => p.value ? gt : mt), h = S(), f = S(!1), _ = Qt(`loading-emails-${a.email_account_name}`, !1); async function b() { if (h.value = vt(a, p.value), h.value) return; const x = { ...c.accountData }, D = { ...a }, Y = x.email_account_name !== D.email_account_name; delete x.email_account_name, delete D.email_account_name; const ne = g.value, G = D; if (!Y && !ne) { J.create({ message: "No changes made", icon: ee($e, { class: "text-ink-blue-2" }) }); return } if (Y) try { f.value = !0, await v(), E() } catch { $() } if (ne) try { f.value = !0, await M(G), E() } catch { $() } } function m() { _.value = !0, J.create({ message: "Pulling emails, this may take a few minutes.", icon: ee($e, { class: "text-blue-500" }) }), pe("frappe.email.doctype.email_account.email_account.pull_emails", { email_account: a.email_account_name }).then(() => { localStorage.removeItem(`loading-emails-${a.email_account_name}`), _.value = null, J.success("Emails pulled successfully") }).catch(() => { localStorage.removeItem(`loading-emails-${a.email_account_name}`), _.value = null, h.value = "Failed to pull emails" }) } const g = N(() => a.email_id !== c.accountData.email_id || a.api_key !== c.accountData.api_key || a.api_secret !== c.accountData.api_secret || a.password !== c.accountData.password || a.enable_incoming !== c.accountData.enable_incoming || a.enable_outgoing !== c.accountData.enable_outgoing || a.default_outgoing !== c.accountData.default_outgoing || a.default_incoming !== c.accountData.default_incoming || a.frappe_mail_site !== c.accountData.frappe_mail_site); async function v() { return await pe("frappe.client.rename_doc", { doctype: "Email Account", old_name: c.accountData.email_account_name, new_name: a.email_account_name }) } async function M(x) { return (await pe("frappe.client.set_value", { doctype: "Email Account", name: a.email_account_name, fieldname: x })).name } function E() { s("update:step", "email-list"), J.success("Email account updated successfully") } function $() { f.value = !1, h.value = "Failed to update email account, Invalid credentials" } return (x, D) => { const Y = j("FormControl"), ne = j("ErrorMessage"), G = j("Button"); return l(), o("div", Ka, [D[2] || (D[2] = e("div", { role: "heading", "aria-level": "1", class: "flex gap-1 justify-between pt-[5px]" }, [e("h5", { class: "text-lg font-semibold" }, "Edit Email")], -1)), e("div", Xa, [r(Me, { logo: t(_t)[x.accountData.service], "service-name": x.accountData.service }, null, 8, ["logo", "service-name"])]), e("div", eo, [r(t($e), { class: "h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-ink-blue-2" }), e("div", to, [le(B(u.description) + " ", 1), e("a", { href: u.link, target: "_blank", class: "text-ink-blue-2 underline" }, "here", 8, no), D[1] || (D[1] = le(" . "))])]), e("div", lo, [e("div", ao, [(l(!0), o(F, null, H(d.value, I => (l(), o("div", { key: I.name, class: "flex flex-col gap-1" }, [r(Y, { modelValue: a[I.name], "onUpdate:modelValue": K => a[I.name] = K, label: I.label, name: I.name, type: I.type, placeholder: I.placeholder }, null, 8, ["modelValue", "onUpdate:modelValue", "label", "name", "type", "placeholder"])]))), 128))]), e("div", oo, [(l(!0), o(F, null, H(t(pt), I => (l(), o("div", { key: I.name, class: "flex flex-col gap-1" }, [r(Y, { modelValue: a[I.name], "onUpdate:modelValue": K => a[I.name] = K, label: I.label, name: I.name, type: I.type }, null, 8, ["modelValue", "onUpdate:modelValue", "label", "name", "type"]), e("p", so, B(I.description), 1)]))), 128))]), h.value ? (l(), w(ne, { key: 0, class: "ml-1", message: h.value }, null, 8, ["message"])) : k("", !0)]), e("div", io, [r(G, { label: "Back", theme: "gray", variant: "outline", disabled: f.value, onClick: D[0] || (D[0] = I => s("update:step", "email-list")) }, null, 8, ["disabled"]), e("div", ro, [r(G, { label: "Update Account", variant: "solid", onClick: b, loading: f.value }, null, 8, ["loading"]), x.accountData.enable_incoming ? (l(), w(G, { key: 0, label: "Pull Emails", variant: "subtle", onClick: m, loading: t(_), disabled: f.value }, null, 8, ["loading", "disabled"])) : k("", !0)])])]) } } }), uo = { class: "flex-1" }, po = { key: 0, class: "h-full" }, mo = { key: 1, class: "h-full" }, go = { key: 2, class: "h-full" }, fo = z({ __name: "EmailConfig", setup(i) { const n = S("email-list"), c = S(null); function s(a, u) { n.value = a, c.value = u } return (a, u) => (l(), o("div", uo, [n.value === "email-add" ? (l(), o("div", po, [r(Ha, { "onUpdate:step": s })])) : n.value === "email-list" ? (l(), o("div", mo, [r(Ya, { "onUpdate:step": s })])) : n.value === "email-edit" ? (l(), o("div", go, [r(co, { "account-data": c.value, "onUpdate:step": s }, null, 8, ["account-data"])])) : k("", !0)])) } }), _o = { class: "lucide lucide-lock", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function vo(i, n) { return l(), o("svg", _o, n[0] || (n[0] = [e("rect", { width: "18", height: "11", x: "3", y: "11", rx: "2", ry: "2" }, null, -1), e("path", { d: "M7 11V7a5 5 0 0 1 10 0v4" }, null, -1)])) } const ho = V({ name: "lucide-lock", render: vo }), ko = { class: "lucide lucide-lock-open", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function Co(i, n) { return l(), o("svg", ko, n[0] || (n[0] = [e("rect", { width: "18", height: "11", x: "3", y: "11", rx: "2", ry: "2" }, null, -1), e("path", { d: "M7 11V7a5 5 0 0 1 9.9-1" }, null, -1)])) } const bo = V({ name: "lucide-unlock", render: Co }), Ao = { class: "w-full h-full flex flex-col" }, xo = { class: "flex items-center justify-between mb-4" }, yo = { class: "flex items-center gap-1 justify-center -ml-[16px]" }, wo = { class: "flex flex-col gap-4 h-full" }, $o = { class: "flex gap-2 items-end" }, Eo = { class: "flex items-center justify-between !w-full" }, Io = { class: "flex items-center gap-1" }, So = { class: "text-gray-600 text-sm" }, Bo = { key: 0, class: "flex flex-col divide-y divide-gray-200 overflow-y-scroll hide-scrollbar h-full" }, Lo = { key: 1, class: "flex justify-center h-full" }, Vo = z({ __name: "TeamEdit", props: { teamName: {} }, emits: ["update:step"], setup(i, { emit: n }) { var P; const c = i, s = n, { getUser: a } = ze(), { teamRestrictionApplied: u } = Ge(), p = S(c.teamName), d = Mt({ doctype: "HD Team", name: c.teamName, auto: !0, delete: { onSuccess() { J.success("Team deleted"), s("update:step", "team-list") } } }), h = N({ get() { var A; return !!((A = d.doc) != null && A.ignore_restrictions) }, set(A) { d.doc && d.setValue.submit({ ignore_restrictions: A }) } }), f = S(""), _ = N(() => { var y; return (((y = d.doc) == null ? void 0 : y.users) || []).map(x => { let D = a(x.user); return { name: x.user, user_image: D.user_image, agent_name: D.full_name } }) }), b = N(() => ({ name: ["not in", _.value.map(A => A.name)] })); function m(A) { var x, D; const y = (D = (x = d.doc) == null ? void 0 : x.users) == null ? void 0 : D.filter(Y => Y.user !== A); d.setValue.submit({ users: y }) } function g(A) { const y = d.doc.users.concat([{ user: A }]); d.setValue.submit({ users: y }), f.value = "" } const v = S(!1), M = { title: "Rename team", message: "Enter the new name for the team", actions: [{ label: "Confirm", variant: "solid", loading: d.loading, onClick: ({ close: A }) => { E(A) } }] }; function E(A) { ae({ url: "frappe.client.rename_doc", makeParams() { return { doctype: "HD Team", old_name: c.teamName, new_name: p.value } }, validate(x) { if (!x.new_name) return "New title is required"; if (x.new_name === x.old_name) return "New and old title cannot be same" }, onSuccess() { J.success("Team renamed"), A(), s("update:step", "team-list") } }).submit() } const $ = S(!1), L = [{ label: "Rename", icon: "edit-3", onClick: () => v.value = !v.value }, { condition: () => u, label: (P = d.doc) != null && P.ignore_restrictions ? "Disable Bypass Restrictions" : "Enable Bypass Restrictions", component: () => ee(Oe, { text: h.value ? "Members of this team will see the tickets assigned to this team only" : "Members of this team will be able to see the tickets assigned to all the teams" }, { default: () => { var A, y; return [ee("div", { class: "flex items-center gap-2 p-2 cursor-pointer hover:bg-gray-100 rounded", onClick: () => h.value = !h.value }, [ee((A = d.doc) != null && A.ignore_restrictions ? ho : bo, { class: "h-4 w-4 text-gray-700", stroke: "currentColor", "aria-hidden": "true" }), ee("span", { class: "whitespace-nowrap text-ink-gray-7 text-p-base" }, [(y = d.doc) != null && y.ignore_restrictions ? "Access only this team's tickets" : "Access all team tickets"])])] } }) }, { label: "Delete", component: ee(O, { label: "Delete", variant: "ghost", iconLeft: "trash-2", theme: "red", style: "width: 100%; justify-content: flex-start;", onClick: () => { $.value = !$.value } }) }]; return (A, y) => { const x = We, D = Ie, Y = Ee, ne = He, G = j("FormControl"); return l(), o(F, null, [e("div", Ao, [e("div", xo, [e("div", yo, [r(t(O), { variant: "ghost", "icon-left": "chevron-left", label: A.teamName, size: "md", onClick: y[0] || (y[0] = () => s("update:step", "team-list")), class: "cursor-pointer hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5" }, null, 8, ["label"])]), r(t(Xe), { placement: "right", options: L }, { default: C(() => [r(t(O), { variant: "ghost" }, { icon: C(() => [r(x, { class: "h-4 w-4" })]), _: 1 })]), _: 1 })]), e("div", wo, [e("div", $o, [r(un, { doctype: "HD Agent", class: "form-control flex-1", placeholder: "Search members", modelValue: f.value, "onUpdate:modelValue": y[1] || (y[1] = I => f.value = I), label: "Members", "hide-me": !0, filters: b.value }, { prefix: C(() => [r(D, { class: "h-4 w-4 text-gray-500 mr-2" })]), "item-label": C(({ option: I }) => { var K, Ae; return [e("div", Eo, [e("div", Io, [r(t(Se), { label: I.label || I.value, image: (K = t(a)(I.label)) == null ? void 0 : K.user_image, size: "sm" }, null, 8, ["label", "image"]), e("p", null, B(((Ae = t(a)(I.label)) == null ? void 0 : Ae.full_name) || "User"), 1)]), e("p", So, B(I.label), 1)])] }), _: 1 }, 8, ["modelValue", "filters"]), r(t(O), { label: "Add", variant: "solid", disabled: !f.value, onClick: y[2] || (y[2] = I => g(f.value)) }, { prefix: C(() => [r(Y, { class: "h-4 w-4 stroke-1.5" })]), _: 1 }, 8, ["disabled"])]), _.value.length ? (l(), o("div", Bo, [(l(!0), o(F, null, H(_.value, (I, K) => (l(), o("div", { key: I.user, class: q(["group py-2", K == _.value.length - 1 && "mb-12"]) }, [r(lt, { agent: I, class: "!py-0" }, { right: C(() => [r(t(O), { variant: "ghost", onClick: me(() => m(I.name), ["stop"]), theme: "red", class: "opacity-0 group-hover:opacity-100", disabled: t(d).loading }, { icon: C(() => [r(ne, { class: "h-4 w-4" })]), _: 2 }, 1032, ["onClick", "disabled"])]), _: 2 }, 1032, ["agent"])], 2))), 128))])) : (l(), o("div", Lo, y[7] || (y[7] = [e("p", { class: "text-p-base text-gray-500" }, "No members found", -1)])))])]), r(t(ke), { modelValue: $.value, "onUpdate:modelValue": y[4] || (y[4] = I => $.value = I), options: { title: "Delete team" } }, { "body-content": C(() => [y[8] || (y[8] = e("p", { class: "text-p-base text-ink-gray-7" }, " Are you sure you want to delete this team? This action cannot be reversed! ", -1)), r(t(O), { variant: "solid", class: "mt-4 float-right", label: "Confirm", theme: "red", onClick: y[3] || (y[3] = () => { t(d).delete.submit(), $.value = !1 }) })]), _: 1 }, 8, ["modelValue"]), r(t(ke), { modelValue: v.value, "onUpdate:modelValue": y[6] || (y[6] = I => v.value = I), options: M }, { "body-content": C(() => [r(G, { modelValue: p.value, "onUpdate:modelValue": y[5] || (y[5] = I => p.value = I), label: "Title", placeholder: "Product Experts" }, null, 8, ["modelValue"])]), _: 1 }, 8, ["modelValue"])], 64) } } }), Qo = z({ __name: "NewTeamModal", props: { modelValue: {}, modelModifiers: {} }, emits: be(["create"], ["update:modelValue"]), setup(i, { emit: n }) { const c = n, s = ge(i, "modelValue"), a = S(null), u = ae({ url: "frappe.client.insert", makeParams() { return { doc: { doctype: "HD Team", team_name: a.value } } }, validate(p) { if (Rt.isEmpty(p.doc.team_name)) return "Title is required" }, auto: !1, onSuccess() { J.success("Team created"), a.value = null, s.value = !1, c("create") } }); return (p, d) => { const h = j("FormControl"), f = j("Dialog"); return l(), w(f, { modelValue: s.value, "onUpdate:modelValue": d[2] || (d[2] = _ => s.value = _), options: { title: "New team", actions: [{ label: "Create", variant: "solid", onClick: () => { t(u).submit() } }] } }, { "body-content": C(() => [e("form", { class: "space-y-2", onSubmit: d[1] || (d[1] = me((..._) => t(u).submit && t(u).submit(..._), ["prevent"])) }, [r(h, { modelValue: a.value, "onUpdate:modelValue": d[0] || (d[0] = _ => a.value = _), label: "Title", placeholder: "Product experts", type: "text" }, null, 8, ["modelValue"])], 32)]), _: 1 }, 8, ["modelValue", "options"]) } } }), Mo = { class: "w-full h-full flex flex-col" }, Ro = { class: "flex items-center justify-between mb-4" }, Do = { class: "flex item-center space-x-2" }, Fo = { key: 0, class: "divide-y w-full h-full hide-scrollbar overflow-y-scroll" }, jo = ["onClick"], To = { class: "flex items-center gap-2" }, Uo = { key: 1, class: "flex mt-28 justify-between w-full h-full" }, No = { key: 2, class: "flex mt-28 justify-between w-full h-full" }, Ho = z({ __name: "TeamsList", emits: ["update:step"], setup(i, { emit: n }) { const c = n, s = Ve({ doctype: "HD Team", cache: ["Teams"], fields: ["name"], auto: !0, orderBy: "creation desc" }), a = S(""), u = S(!1); return ve(a, p => { s.filters = { name: ["like", `%${p}%`] }, p || (s.start = 0, s.pageLength = 10), s.reload() }), (p, d) => { var b, m; const h = Ie, f = Ee, _ = j("Button"); return l(), o(F, null, [e("div", Mo, [e("div", Ro, [d[4] || (d[4] = e("h1", { class: "text-lg font-semibold" }, "Teams", -1)), e("div", Do, [r(t(qe), { modelValue: a.value, "onUpdate:modelValue": d[0] || (d[0] = g => a.value = g), placeholder: "Search", type: "text", debounce: 300 }, { prefix: C(() => [r(h, { class: "h-4 w-4 text-gray-500" })]), _: 1 }, 8, ["modelValue"]), r(_, { onClick: d[1] || (d[1] = () => u.value = !u.value), label: "New", variant: "solid" }, { prefix: C(() => [r(f, { class: "h-4 w-4 stroke-1.5" })]), _: 1 })])]), !t(s).loading && ((b = t(s).data) == null ? void 0 : b.length) > 0 ? (l(), o("div", Fo, [(l(!0), o(F, null, H(t(s).data, g => (l(), o("div", { key: g.name, class: "flex items-center gap-2 py-2 group justify-between cursor-pointer", onClick: () => c("update:step", "team-edit", g.name) }, [e("div", To, [r(t(Se), { label: g.name, size: "sm" }, null, 8, ["label"]), (l(), o("p", { key: g.name, class: "text-p-base text-gray-700" }, B(g.name), 1))])], 8, jo))), 128))])) : k("", !0), t(s).loading ? (l(), o("div", Uo, [r(_, { loading: t(s).loading, variant: "ghost", class: "w-full", size: "2xl" }, null, 8, ["loading"])])) : k("", !0), (m = t(s).data) != null && m.length ? k("", !0) : (l(), o("div", No, d[5] || (d[5] = [e("p", { class: "text-sm text-gray-500 w-full flex justify-center" }, " No teams found ", -1)])))]), r(Qo, { modelValue: u.value, "onUpdate:modelValue": d[2] || (d[2] = g => u.value = g), onCreate: d[3] || (d[3] = () => { t(s).reload() }) }, null, 8, ["modelValue"])], 64) } } }), Oo = { key: 0, class: "h-full" }, Po = { key: 1, class: "h-full" }, Zo = z({ __name: "TeamsConfig", setup(i) { const n = S("team-list"), c = S(""); function s(a, u) { n.value = a, c.value = u } return (a, u) => n.value === "team-list" ? (l(), o("div", Oo, [r(Ho, { "onUpdate:step": s })])) : n.value === "team-edit" ? (l(), o("div", Po, [r(Vo, { "onUpdate:step": s, "team-name": c.value }, null, 8, ["team-name"])])) : k("", !0) } }), zo = { class: "flex", style: { height: "calc(100vh - 8rem)" } }, Jo = { class: "flex w-52 shrink-0 flex-col bg-gray-50 p-2" }, qo = { class: "mt-3 space-y-1" }, Go = ["onClick"], Wo = { class: "text-base text-gray-800" }, Yo = { class: "flex flex-1 flex-col px-10 py-8 bg-surface-modal" }, Ko = z({ __name: "SettingsModal", props: be({ defaultTab: { default: 0 } }, { modelValue: {}, modelModifiers: {} }), emits: ["update:modelValue"], setup(i) { const n = i; let c = [{ label: "Email Accounts", icon: V(nt), component: V(fo) }, { label: "Branding", icon: V(Gl), component: V(wa) }, { label: "Agents", icon: V(on), component: V(ka) }, { label: "Teams", icon: V(sn), component: V(Zo) }]; const s = ge(i, "modelValue"), a = S(c[n.defaultTab]); return ve(() => n.defaultTab, u => { a.value = c[u] }), (u, p) => (l(), w(t(ke), { modelValue: s.value, "onUpdate:modelValue": p[0] || (p[0] = d => s.value = d), options: { size: "4xl" } }, { body: C(() => [e("div", zo, [e("div", Jo, [p[1] || (p[1] = e("h1", { class: "px-2 pt-2 text-lg font-semibold" }, "Settings", -1)), e("div", qo, [(l(!0), o(F, null, H(t(c), d => { var h; return l(), o("button", { key: d.label, class: q(["flex h-7 w-full items-center gap-2 rounded px-2 py-1", [((h = a.value) == null ? void 0 : h.label) == d.label ? "bg-white shadow-sm" : "hover:bg-gray-100"]]), onClick: f => a.value = d }, [(l(), w(ie(d.icon), { class: "h-4 w-4 text-gray-700" })), e("span", Wo, B(d.label), 1)], 10, Go) }), 128))])]), e("div", Yo, [a.value ? (l(), w(ie(a.value.component), { key: 0, class: "h-full flex flex-col w-full" })) : k("", !0)])])]), _: 1 }, 8, ["modelValue"])) } }), ht = S("https://frappecloud.com"), kt = S(""), Xo = ae({ url: "frappe.integrations.frappe_providers.frappecloud_billing.current_site_info", cache: "currentSiteInfo", onSuccess: i => { ht.value = i.base_url, kt.value = i.site_name } }), es = () => { const { $dialog: i } = et(); Xo.fetch(), i({ title: "Login to Frappe Cloud?", message: "Are you sure you want to login to your Frappe Cloud dashboard?", actions: [{ label: "Confirm", variant: "solid", onClick(n) { ts(), n() } }] }) }, ts = () => { window.open(`${ht.value}/dashboard/sites/${kt.value}`, "_blank") }, ns = { class: "lucide lucide-arrow-left-from-line", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function ls(i, n) { return l(), o("svg", ns, n[0] || (n[0] = [e("path", { d: "m9 6-6 6 6 6" }, null, -1), e("path", { d: "M3 12h14" }, null, -1), e("path", { d: "M21 19V5" }, null, -1)])) } const as = V({ name: "lucide-arrow-left-from-line", render: ls }), os = { class: "lucide lucide-arrow-right-from-line", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function ss(i, n) { return l(), o("svg", os, n[0] || (n[0] = [e("path", { d: "M3 5v14" }, null, -1), e("path", { d: "M21 12H7" }, null, -1), e("path", { d: "m15 18 6-6-6-6" }, null, -1)])) } const is = V({ name: "lucide-arrow-right-from-line", render: ss }), rs = { class: "lucide lucide-globe", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function cs(i, n) { return l(), o("svg", rs, n[0] || (n[0] = [e("circle", { cx: "12", cy: "12", r: "10" }, null, -1), e("path", { d: "M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20" }, null, -1), e("path", { d: "M2 12h20" }, null, -1)])) } const us = V({ name: "lucide-globe", render: cs }), ds = { class: "lucide lucide-mail-open", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function ps(i, n) { return l(), o("svg", ds, n[0] || (n[0] = [e("path", { d: "M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z" }, null, -1), e("path", { d: "m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10" }, null, -1)])) } const ms = V({ name: "lucide-mail-open", render: ps }), gs = { class: "lucide lucide-message-circle", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function fs(i, n) { return l(), o("svg", gs, n[0] || (n[0] = [e("path", { d: "M7.9 20A9 9 0 1 0 4 16.1L2 22Z" }, null, -1)])) } const _s = V({ name: "lucide-message-circle", render: fs }), vs = { class: "lucide lucide-timer", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function hs(i, n) { return l(), o("svg", vs, n[0] || (n[0] = [e("line", { x1: "10", x2: "14", y1: "2", y2: "2" }, null, -1), e("line", { x1: "12", x2: "15", y1: "14", y2: "11" }, null, -1), e("circle", { cx: "12", cy: "14", r: "8" }, null, -1)])) } const ks = V({ name: "lucide-timer", render: hs }), Cs = { class: "lucide lucide-user-pen", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function bs(i, n) { return l(), o("svg", Cs, n[0] || (n[0] = [e("path", { d: "M11.5 15H7a4 4 0 0 0-4 4v2" }, null, -1), e("path", { d: "M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z" }, null, -1), e("circle", { cx: "10", cy: "7", r: "4" }, null, -1)])) } const As = V({ name: "lucide-user-pen", render: bs }), xs = { class: "lucide lucide-user-plus", xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "1.5", "stroke-linecap": "round", "stroke-linejoin": "round" }; function ys(i, n) { return l(), o("svg", xs, n[0] || (n[0] = [e("path", { d: "M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" }, null, -1), e("circle", { cx: "9", cy: "7", r: "4" }, null, -1), e("line", { x1: "19", x2: "19", y1: "8", y2: "14" }, null, -1), e("line", { x1: "22", x2: "16", y1: "11", y2: "11" }, null, -1)])) } const ws = V({ name: "lucide-user-plus", render: ys }), $s = { class: "flex items-center gap-0.5 font-medium text-gray-600" }, Es = { key: 2, class: "mb-4" }, Is = { key: 0, class: "absolute z-20 h-1.5 w-1.5 translate-x-6 translate-y-1 rounded-full bg-blue-400 left-1", theme: "gray", variant: "solid" }, Ss = { class: "overflow-y-auto overflow-x-hidden" }, Bs = { key: 0, class: "mx-2 my-2 h-1 border-b" }, Ls = ["onClick"], Vs = { class: "flex flex-col" }, Qs = { class: "flex flex-col gap-1" }, Ms = z({ __name: "Sidebar", setup(i) { const { isMobileView: n } = Dt(), c = Ft(), s = jt(), a = Qe(), u = Ke(), { isExpanded: p, width: d } = Tt(Ye()), h = Ut(), { $socket: f } = et(), _ = S(!1), { pinnedViews: b, publicViews: m } = Ot(), g = S(window.is_fc_site), v = N(() => { var xe, ye; const Q = [{ label: "All Views", hideLabel: !0, opened: !0, views: X.value ? Wt : Yt }]; return (xe = m.value) != null && xe.length && !X.value && Q.push({ label: "Public Views", opened: !0, hideLabel: !1, views: M(m.value) }), (ye = b.value) != null && ye.length && Q.push({ label: "Private Views", opened: !0, hideLabel: !1, views: M(b.value) }), Q }); function M(R) { return R.map(Q => ({ label: Q.label, icon: Q.icon, to: { name: Q.route_name, query: { view: Q.name } }, onClick: () => { Pt.value = { label: Q.label, icon: Q.icon } } })) } const E = N(() => [{ label: "Log out", icon: "log-out", onClick: () => a.logout() }]), $ = N(() => [{ component: V(Kt) }, { label: "Customer portal", icon: "users", onClick: () => { const R = s.resolve({ name: "TicketsCustomer" }); window.open(R.href) } }, { icon: "life-buoy", label: "Support", onClick: () => window.open("https://t.me/frappedesk") }, { icon: "book-open", label: "Docs", onClick: () => window.open("https://docs.frappe.io/helpdesk") }, { label: "Login to Frappe Cloud", icon: In, onClick: () => es(), condition: () => !n.value && window.is_fc_site }, { label: "Settings", icon: "settings", onClick: () => _.value = !0, condition: () => a.isAdmin || a.isManager }, { group: "Danger", hideLabel: !0, items: [{ label: "Log out", icon: "log-out", onClick: () => a.logout() }] }]), L = N(() => X.value ? E.value : $.value); function P(R) { var Q; return c.query.view ? c.query.view == ((Q = R == null ? void 0 : R.query) == null ? void 0 : Q.view) : c.name === R } function A() { window.dispatchEvent(new KeyboardEvent("keydown", { key: "k", metaKey: !0 })) } const y = ee(Xt, { class: "h-12 w-12" }, null), x = S(0), D = N(() => !X.value && !K.value && a.isManager), Y = [{ name: "setup_email_account", title: "Connect your support email", completed: !1, icon: V(nt), onClick: () => { Z.value = !0, _.value = !0, x.value = 0 } }, { name: "invite_agents", title: "Invite agents", completed: !1, icon: V(ws), onClick: () => { Z.value = !0, _.value = !0, x.value = 2, setTimeout(() => { ce.value = !0 }, 300) } }, { name: "setup_sla", title: "Setup SLA", completed: !1, icon: V(ks), onClick: () => { console.log("clicked"); const R = "/app/hd-service-level-agreement"; window.open(R, "_blank") } }, { name: "create_first_ticket", title: "Create a ticket", completed: !1, icon: V(Zt), onClick: () => { s.push({ name: "TicketAgentNew" }), Z.value = !0 } }, { name: "assign_to_agent", title: "Assign a ticket to an agent", completed: !1, icon: V(As), onClick: async () => { await Be(), zt.value = !0, Z.value = !0 } }, { name: "reply_on_ticket", title: "Reply on a ticket", completed: !1, icon: V(ms), onClick: async () => { await Be(), Fe.value = !0, je.value = !1, Z.value = !0 } }, { name: "comment_on_ticket", title: "Add a comment on a ticket", completed: !1, icon: V(_s), onClick: async () => { await Be(), je.value = !0, Fe.value = !1, Z.value = !0 } }, { name: "first_article", title: "Create an article", completed: !1, icon: V(Jt), onClick: async () => { const R = await bt(); s.push({ name: "NewArticle", query: { title: "General" }, params: { id: R } }), Z.value = !0 } }, { name: "add_invite_contact", title: "Create & invite a contact", completed: !1, icon: V(Vn), onClick: () => { console.log("clicked"), Z.value = !0, I.value = { title: "Create & invite a contact", buttonLabel: "Create", videoURL: "/assets/helpdesk/desk/videos/createInviteContact.mp4", onClick: async () => { G.value = !1, s.push({ name: "ContactList" }), dn.value = !0 } }, G.value = !0 } }, { name: "explore_customer_portal", title: "Explore customer portal", completed: !1, icon: V(us), onClick: () => { window.open("/helpdesk/my-tickets", "_blank"), Re("explore_customer_portal"), Z.value = !0 } }], ne = S([{ title: "Introduction", opened: !1, subArticles: [{ name: "introduction", title: "Introduction" }, { name: "setting-up", title: "Setting up" }] }, { title: "Getting Started", opened: !1, subArticles: [{ name: "lesson-1-your-first-ticket", title: "Creating a ticket" }, { name: "lesson-2understanding-ticket-view", title: "Understanding ticket view" }, { name: "lesson-3-agents-teams", title: "Agents & Teams" }, { name: "customers-contacts", title: "Customers & Contacts" }, { name: "lesson-4-knowledge-base", title: "Knowledge Base" }, { name: "customer-portal", title: "Customer Portal" }] }, { title: "Masters", opened: !1, subArticles: [{ name: "ticket", title: "Ticket" }, { name: "agent", title: "Agent" }, { name: "team", title: "Team" }, { name: "contact", title: "Contact" }, { name: "customer", title: "Customer" }, { name: "knowledge-base", title: "Knowledge Base" }, { name: "canned-response", title: "Canned Responses" }, { name: "service-level-agreement", title: "Service Level Agreement" }, { name: "ticket-type", title: "Ticket Type" }, { name: "ticket-priority", title: "Ticket Priority" }] }, { title: "Customizations", opened: !1, subArticles: [{ name: "custom-actions", title: "Custom Actions" }, { name: "field-dependency", title: "Field Dependency" }, { name: "custom-views", title: "Custom Views" }, { name: "settings", title: "Settings" }] }, { title: "Frappe Helpdesk Mobile", opened: !1, subArticles: [{ name: "pwa-installation", title: "Mobile App Installation" }] }]), G = S(!1), I = S({}), { isOnboardingStepsCompleted: K, setUp: Ae, updateOnboardingStep: Re } = fe("helpdesk"); async function Be() { const R = await Ct(); R ? s.push({ name: "TicketAgent", params: { ticketId: R } }) : s.push({ name: "TicketAgentNew" }) } async function Ct() { let R = localStorage.getItem("firstTicket"); return R || await pe("terrasuitehelpdesk.api.onboarding.get_first_ticket") } async function bt() { let R = localStorage.getItem("generalCategoryId"); if (!R) { if (R = await pe("terrasuitehelpdesk.api.onboarding.get_general_category_id"), !R) return; localStorage.setItem("generalCategoryId", R) } return R } function At() { a.isManager && (f.on("update_sla_status", () => { Re("setup_sla") }), Ae(Y)) } return Le(() => { At() }), Nt(() => { f.off("update_sla_status") }), (R, Q) => { const xe = j("Badge"), ye = j("FeatherIcon"); return l(), o("div", { class: "flex select-none flex-col border-r border-gray-200 bg-gray-50 p-2 text-base duration-300 ease-in-out", style: Ne({ "min-width": t(d), "max-width": t(d) }) }, [r(en, { class: "mb-2", options: L.value }, null, 8, ["options"]), t(X) ? k("", !0) : (l(), w(t(ue), { key: 0, label: "Search", class: "my-0.5", icon: t(Ie), "on-click": () => A(), "is-expanded": t(p) }, { right: C(() => [e("span", $s, [(l(), w(ie(t(h).modifierIcon), { class: "h-3 w-3" })), Q[5] || (Q[5] = e("span", null, "K", -1))])]), _: 1 }, 8, ["icon", "on-click", "is-expanded"])), t(X) ? k("", !0) : (l(), w(t(ue), { key: 1, class: "relative my-0.5 min-h-7", label: "Dashboard", icon: t(tn), to: "Dashboard", "is-active": P("Dashboard"), "is-expanded": t(p) }, null, 8, ["icon", "is-active", "is-expanded"])), t(X) ? k("", !0) : (l(), o("div", Es, [t(u).unread ? (l(), o("div", Is)) : k("", !0), r(t(ue), { class: "relative my-0.5", label: "Notifications", icon: t(ln), "on-click": () => t(u).toggle(), "is-expanded": t(p) }, { right: C(() => [t(p) && t(u).unread ? (l(), w(xe, { key: 0, label: t(u).unread > 9 ? "9+" : t(u).unread, theme: "gray", variant: "subtle" }, null, 8, ["label"])) : k("", !0)]), _: 1 }, 8, ["icon", "on-click", "is-expanded"])])), e("div", Ss, [(l(!0), o(F, null, H(v.value, T => { var De; return l(), o("div", { key: T.label }, [!T.hideLabel && !t(p) && ((De = T.views) != null && De.length) ? (l(), o("div", Bs)) : k("", !0), r(t(nn), { label: T.label, hideLabel: T.hideLabel, opened: T.opened }, { header: C(({ opened: oe, hide: xt, toggle: yt }) => [xt ? k("", !0) : (l(), o("div", { key: 0, class: q(["flex cursor-pointer gap-1.5 px-1 text-base font-medium text-ink-gray-5 transition-all duration-300 ease-in-out", t(p) ? "mt-4 h-7 w-auto opacity-100" : "ml-0 h-0 overflow-hidden opacity-0"]), onClick: Fs => yt() }, [r(ye, { name: "chevron-right", class: q(["h-4 text-ink-gray-9 transition-all duration-300 ease-in-out", { "rotate-90": oe }]) }, null, 8, ["class"]), e("span", null, B(T.label), 1)], 10, Ls))]), default: C(() => [e("nav", Vs, [(l(!0), o(F, null, H(T.views, oe => (l(), w(t(ue), { icon: oe.icon, label: oe.label, to: oe.to, key: oe.label, "is-expanded": t(p), "is-active": P(oe.to), class: "my-0.5 emoji", onClick: oe.onClick }, null, 8, ["icon", "label", "to", "is-expanded", "is-active", "onClick"]))), 128))])]), _: 2 }, 1032, ["label", "hideLabel", "opened"])]) }), 128))]), Q[6] || (Q[6] = e("div", { class: "grow" }, null, -1)), e("div", Qs, [g.value && !t(X) ? (l(), w(t(Ue), { key: 0, isSidebarCollapsed: !t(p) }, null, 8, ["isSidebarCollapsed"])) : k("", !0), D.value ? (l(), w(t(Sl), { key: 1, isSidebarCollapsed: !t(p), appName: "helpdesk" }, null, 8, ["isSidebarCollapsed"])) : k("", !0), t(K) && !t(X) ? (l(), w(t(ue), { key: 2, icon: tt, label: "Help", "is-expanded": t(p), onClick: Q[0] || (Q[0] = () => { se.value = t(Z) ? !0 : !t(se), Z.value = !t(se) }) }, null, 8, ["is-expanded"])) : k("", !0), r(t(ue), { icon: t(p) ? t(as) : t(is), "is-active": !1, "is-expanded": t(p), label: t(p) ? "Collapse" : "Expand", "on-click": () => p.value = !t(p) }, null, 8, ["icon", "is-expanded", "label", "on-click"])]), g.value && !t(X) ? (l(), w(t(Ue), { key: 3, isSidebarCollapsed: !t(p) }, null, 8, ["isSidebarCollapsed"])) : k("", !0), r(Ko, { modelValue: _.value, "onUpdate:modelValue": Q[1] || (Q[1] = T => _.value = T), "default-tab": x.value }, null, 8, ["modelValue", "default-tab"]), t(se) ? (l(), w(t(bl), { key: 4, modelValue: t(se), "onUpdate:modelValue": Q[2] || (Q[2] = T => Je(se) ? se.value = T : null), articles: ne.value, "onUpdate:articles": Q[3] || (Q[3] = T => ne.value = T), appName: "helpdesk", title: "Frappe Helpdesk", logo: t(y), docsLink: "https://docs.frappe.io/helpdesk", afterSkip: T => t(we)("onboarding_step_skipped_" + T), afterSkipAll: () => t(we)("onboarding_steps_skipped"), afterReset: T => t(we)("onboarding_step_reset_" + T), afterResetAll: () => t(we)("onboarding_steps_reset") }, null, 8, ["modelValue", "articles", "logo", "afterSkip", "afterSkipAll", "afterReset", "afterResetAll"])) : k("", !0), r(t(Ml), { modelValue: G.value, "onUpdate:modelValue": Q[4] || (Q[4] = T => G.value = T), currentStep: I.value }, null, 8, ["modelValue", "currentStep"])], 4) } } }), Rs = { class: "flex h-screen w-screen" }, Ds = { class: "flex-1 flex flex-col h-full overflow-auto" }, Xs = { __name: "DesktopLayout", setup(i) { return (n, c) => (l(), o("div", Rs, [r(Ms), e("div", Ds, [r(Zl), _e(n.$slots, "default")]), r(t(yn)), r(t(qt))])) } }; export { Xs as default };
//# sourceMappingURL=DesktopLayout-f9c52e3e.js.map
