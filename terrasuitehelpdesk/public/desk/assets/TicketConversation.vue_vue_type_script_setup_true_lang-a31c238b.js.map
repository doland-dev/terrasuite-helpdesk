{"version":3,"file":"TicketConversation.vue_vue_type_script_setup_true_lang-a31c238b.js","sources":["../../../../desk/src/pages/ticket/TicketConversation.vue"],"sourcesContent":["<template>\n  <div\n    class=\"mx-6 md:mx-10 md:my-2 flex items-center justify-between text-lg font-medium mb-4 !mt-8\"\n  >\n    Activity\n  </div>\n  <div class=\"overflow-auto px-6 md:px-10 grow\">\n    <div\n      v-for=\"(c, i) in communications\"\n      :id=\"c.name\"\n      :key=\"c.name\"\n      class=\"flex items-between justify-center gap-4 relative\"\n      :class=\"i === 0 && 'mt-4'\"\n    >\n      <div\n        class=\"w-full activity grid grid-cols-[30px_minmax(auto,_1fr)] gap-2 sm:gap-4 h-full\"\n      >\n        <div\n          class=\"relative flex justify-center after:absolute after:left-[50%] after:top-3 after:-z-10 after:border-l after:border-gray-200\"\n          :class=\"[\n            i != communications.length - 1 ? 'after:h-full' : 'after:h-5',\n          ]\"\n        >\n          <Avatar\n            size=\"lg\"\n            :label=\"c.user.name\"\n            :image=\"c.user.image\"\n            class=\"mt-1.5 relative\"\n          />\n        </div>\n        <TicketCommunication\n          :content=\"c.content\"\n          :date=\"c.creation\"\n          :user=\"c.user\"\n          :sender-image=\"c.sender\"\n          :cc=\"c.cc || ''\"\n          :bcc=\"c.bcc || ''\"\n          :attachments=\"c.attachments\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { dayjs } from \"@/dayjs\";\nimport { Avatar } from \"frappe-ui\";\nimport { orderBy } from \"lodash\";\nimport { computed, inject, nextTick, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport TicketCommunication from \"./TicketCommunication.vue\";\nimport { ITicket } from \"./symbols\";\n\ninterface P {\n  focus?: string;\n}\n\nconst props = withDefaults(defineProps<P>(), {\n  focus: \"\",\n});\nconst route = useRoute();\nconst ticket = inject(ITicket);\nconst communications = computed(() => {\n  const _communications = ticket.data.communications || [];\n  return orderBy(_communications, (c) => dayjs(c.creation));\n});\n\nfunction isElementInViewport(el: HTMLElement) {\n  if (!el) return false;\n  const rect = el.getBoundingClientRect();\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= window.innerHeight &&\n    rect.right <= window.innerWidth\n  );\n}\n\nfunction scroll(id: string) {\n  const e = document.getElementById(id);\n  if (!isElementInViewport(e)) {\n    e.scrollIntoView();\n  }\n}\n\nwatch(\n  () => props.focus,\n  (id: string) => scroll(id)\n);\nnextTick(() => {\n  const hash = route.hash.slice(1);\n  const id = hash || communications.value.slice(-1).pop()?.name;\n  if (id) setTimeout(() => scroll(id), 1000);\n});\n</script>\n"],"names":["props","__props","route","useRoute","ticket","inject","ITicket","communications","computed","_communications","orderBy","c","dayjs","isElementInViewport","el","rect","scroll","id","watch","nextTick","_a","_cache","_createElementVNode","_hoisted_1","_openBlock","_createElementBlock","_Fragment","_renderList","i","_normalizeClass","_hoisted_3","_createVNode","_unref","Avatar","TicketCommunication"],"mappings":"kmBAyDA,MAAMA,EAAQC,EAGRC,EAAQC,IACRC,EAASC,EAAOC,CAAO,EACvBC,EAAiBC,EAAS,IAAM,CACpC,MAAMC,EAAkBL,EAAO,KAAK,gBAAkB,CAAA,EACtD,OAAOM,EAAAA,QAAQD,EAAkBE,GAAMC,EAAMD,EAAE,QAAQ,CAAC,CAAA,CACzD,EAED,SAASE,EAAoBC,EAAiB,CAC5C,GAAI,CAACA,EAAW,MAAA,GACV,MAAAC,EAAOD,EAAG,wBAChB,OACEC,EAAK,KAAO,GACZA,EAAK,MAAQ,GACbA,EAAK,QAAU,OAAO,aACtBA,EAAK,OAAS,OAAO,UAEzB,CAEA,SAASC,EAAOC,EAAY,CACpB,MAAA,EAAI,SAAS,eAAeA,CAAE,EAC/BJ,EAAoB,CAAC,GACxB,EAAE,eAAe,CAErB,CAEA,OAAAK,EACE,IAAMlB,EAAM,MACXiB,GAAeD,EAAOC,CAAE,CAAA,EAE3BE,EAAS,IAAM,OAEP,MAAAF,EADOf,EAAM,KAAK,MAAM,CAAC,KACZkB,EAAAb,EAAe,MAAM,MAAM,EAAE,EAAE,IAAO,IAAtC,YAAAa,EAAsC,MACrDH,GAAI,WAAW,IAAMD,EAAOC,CAAE,EAAG,GAAI,CAAA,CAC1C,wBA5FCI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,EAIM,MAHJ,CAAA,MAAM,0FACP,aAED,EAAA,GACAA,EAmCM,MAnCNC,EAmCM,EAlCJC,EAAA,EAAA,EAAAC,EAiCMC,EAhCa,KAAAC,EAAApB,EAAA,MAAT,CAAAI,EAAGiB,SADbH,EAiCM,MAAA,CA/BH,GAAId,EAAE,KACN,IAAKA,EAAE,KACR,MAAKkB,EAAA,CAAC,mDACED,IAAC,GAAA,MAAA,CAAA,CAAA,GAETN,EAyBM,MAzBNQ,EAyBM,CAtBJR,EAYM,MAAA,CAXJ,SAAM,4HAA2H,CAC3GM,GAAKrB,EAAc,MAAC,OAAM,EAAA,eAAA,WAAA,MAIhDwB,EAKEC,EAAAC,CAAA,EAAA,CAJA,KAAK,KACJ,MAAOtB,EAAE,KAAK,KACd,MAAOA,EAAE,KAAK,MACf,MAAM,iDAGVoB,EAQEG,EAAA,CAPC,QAASvB,EAAE,QACX,KAAMA,EAAE,SACR,KAAMA,EAAE,KACR,eAAcA,EAAE,OAChB,GAAIA,EAAE,IAAE,GACR,IAAKA,EAAE,KAAG,GACV,YAAaA,EAAE"}