import{d as $,m as z,n as A,p as F,X as L,R as v,k as b,g as l,w as _,h as n,r as x,e as g,l as r,aZ as U,z as R,H,c as k,a_ as P,f as N,t as q,y as I,A as y,N as T,I as O,U as X}from"./index-54e545bb.js";import{L as Z}from"./knowledgeBase-de4d1c97.js";import{_ as j}from"./ListViewBuilder.vue_vue_type_script_setup_true_lang-23f24b4c.js";import{_ as E}from"./Avatar.vue_vue_type_script_setup_true_lang-33c4215a.js";import{F as G}from"./FileUploader-3bc7c8ba.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-20398480.js";import"./more-horizontal-b561c647.js";import"./dayjs-8f71cd34.js";import"./StarRating.vue_vue_type_script_setup_true_lang-87d7ba3b.js";import"./FadedScrollableDiv.vue_vue_type_script_setup_true_lang-897d9728.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-fc0fa242.js";import"./Link-5130f40e.js";import"./globalStore-842ad0ec.js";import"./EmptyState.vue_vue_type_script_setup_true_lang-93f57bdf.js";const J={class:"space-y-4"},K={class:"space-y-1"},Q={class:"space-y-1"},W={class:"float-right flex space-x-2"},Y=$({__name:"NewCustomerDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:z(["customerCreated"],["update:modelValue"]),setup(C,{emit:u}){const m=u,i=A(C,"modelValue"),o=F({customer:"",domain:""}),s=L({url:"frappe.client.insert",method:"POST",data:{doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}},onSuccess:()=>{o.customer="",o.domain="",v.success("Customer created"),m("customerCreated")},onError:c=>{v.error(c.messages[0])}});function p(){if(!o.customer){v.error("Customer name is required");return}s.submit({doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}})}return(c,t)=>{const e=x("Button");return g(),b("div",null,[l(n(H),{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value=a),options:{title:"Add New Customer",size:"sm"}},{"body-content":_(()=>[r("div",J,[r("div",K,[l(n(U),{modelValue:o.customer,"onUpdate:modelValue":t[0]||(t[0]=a=>o.customer=a),label:"Customer Name",type:"text",placeholder:"Tesla Inc."},null,8,["modelValue"])]),r("div",Q,[l(n(U),{modelValue:o.domain,"onUpdate:modelValue":t[1]||(t[1]=a=>o.domain=a),label:"Domain",type:"text",placeholder:"eg: tesla.com, mycompany.com"},null,8,["modelValue"])]),r("div",W,[l(e,{label:"Add",theme:"gray",variant:"solid",onClick:R(p,["prevent"])})])])]),_:1},8,["modelValue"])])}}}),ee={class:"flex flex-col items-center gap-4 p-6"},oe={class:"text-xl font-medium text-gray-900"},te={class:"flex gap-2"},se=$({__name:"CustomerDialog",props:{name:{type:String,required:!0}},emits:["customer-updated"],setup(C,{emit:u}){const m=C,i=u,o=k({get(){var e;return(e=s.doc)==null?void 0:e.domain},set(e){s.doc.domain=e}}),s=P({doctype:"HD Customer",name:m.name,auto:!0,setValue:{onSuccess(){v.success("Customer updated")},onError(){v.error("Error updating customer")}}}),p=k(()=>{var e;return{title:(e=s.doc)==null?void 0:e.name,actions:[{label:"Save",theme:"gray",variant:"solid",onClick:()=>c()}]}});async function c(){await s.setValue.submit({domain:o.value}),i("customer-updated")}function t(e){s.setValue.submit({image:(e==null?void 0:e.file_url)||null}),i("customer-updated")}return(e,a)=>{const V=x("Button"),d=x("Input");return g(),N(n(H),{options:p.value},{"body-main":_(()=>{var h,w,B,D;return[r("div",ee,[r("div",oe,q((h=n(s).doc)==null?void 0:h.name),1),l(n(E),{size:"lg",label:(w=n(s).doc)==null?void 0:w.name,image:(B=n(s).doc)==null?void 0:B.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),r("div",te,[l(n(G),{onSuccess:a[0]||(a[0]=f=>t(f))},{default:_(({uploading:f,openFileSelector:M})=>{var S;return[l(V,{label:(S=n(s).doc)!=null&&S.image?"Change photo":"Upload photo",loading:f,onClick:M},null,8,["label","loading","onClick"])]}),_:1}),(D=n(s).doc)!=null&&D.image?(g(),N(V,{key:0,label:"Remove photo",onClick:a[1]||(a[1]=f=>t(null))})):I("",!0)]),r("form",{class:"w-full",onSubmit:R(c,["prevent"])},[l(d,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=f=>o.value=f),label:"Domain",placeholder:"example.com"},null,8,["modelValue"])],32)])]}),_:1},8,["options"])}}}),ae={class:"flex flex-col"},le={key:0},ye=$({__name:"Customers",setup(C){const u=y(!1),m=y(!1),i=y(null),o=y(null);function s(t){i.value=t,m.value=!0}function p(t=!1){var e;t?m.value=!1:u.value=!1,(e=o.value)==null||e.reload()}const c=k(()=>({doctype:"HD Customer",selectable:!0,showSelectBanner:!0,columnConfig:{name:{prefix:({row:t})=>O(E,{shape:"circle",image:t.image,label:t.name,size:"sm"})}},emptyState:{title:"No Customers Found"}}));return T(()=>({title:"Customers"})),(t,e)=>{const a=X,V=x("Button");return g(),b("div",ae,[l(Z,null,{"left-header":_(()=>e[5]||(e[5]=[r("div",{class:"text-lg font-medium text-gray-900"},"Customers",-1)])),"right-header":_(()=>[l(V,{label:"New customer",theme:"gray",variant:"solid",onClick:e[0]||(e[0]=d=>u.value=!u.value)},{prefix:_(()=>[l(a,{class:"h-4 w-4"})]),_:1})]),_:1}),l(j,{ref_key:"listViewRef",ref:o,options:c.value,onRowClick:s,onEmptyStateAction:e[1]||(e[1]=d=>u.value=!0)},null,8,["options"]),l(Y,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=d=>u.value=d),onCustomerCreated:p},null,8,["modelValue"]),m.value?(g(),b("span",le,[l(se,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=d=>m.value=d),name:i.value,onCustomerUpdated:e[4]||(e[4]=d=>p(!0))},null,8,["modelValue","name"])])):I("",!0)])}}});export{ye as default};
//# sourceMappingURL=Customers-bf4ab84c.js.map
